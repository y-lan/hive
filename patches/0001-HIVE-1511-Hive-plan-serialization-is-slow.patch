From bdfaaf80b7a0ad7394a85717cd070a4daa68178c Mon Sep 17 00:00:00 2001
From: yuyang-lan <yuyang.lan@gree.net>
Date: Thu, 19 Dec 2013 15:45:44 +0900
Subject: [PATCH] [HIVE-1511] Hive plan serialization is slow

---
 .gitignore                                         |   1 +
 .../java/org/apache/hadoop/hive/conf/HiveConf.java |   1 +
 conf/hive-default.xml.template                     |   9 +
 .../contrib/udtf/example/GenericUDTFCount2.java    |   4 +-
 .../contrib/udtf/example/GenericUDTFExplode2.java  |   2 +-
 hcatalog/pom.xml                                   |  11 +-
 ivy/ivysettings.xml                                |   7 +
 ivy/libraries.properties                           |   1 +
 ql/build.xml                                       |  13 +-
 ql/ivy.xml                                         |   2 +
 ql/src/java/org/apache/hadoop/hive/ql/Driver.java  |   4 +-
 .../org/apache/hadoop/hive/ql/exec/ColumnInfo.java |  12 ++
 .../hive/ql/exec/ExprNodeColumnEvaluator.java      |  21 ++-
 .../hadoop/hive/ql/exec/FunctionRegistry.java      |   4 +-
 .../hive/ql/exec/HashTableDummyOperator.java       |   2 +-
 .../org/apache/hadoop/hive/ql/exec/Operator.java   |   4 +-
 .../org/apache/hadoop/hive/ql/exec/RowSchema.java  |   6 +-
 .../org/apache/hadoop/hive/ql/exec/Utilities.java  | 124 +++++++++++--
 .../apache/hadoop/hive/ql/exec/mr/ExecDriver.java  |   4 +-
 .../hive/ql/exec/mr/HadoopJobExecHelper.java       |   2 +-
 .../apache/hadoop/hive/ql/exec/mr/MapRedTask.java  |  12 +-
 .../hadoop/hive/ql/exec/mr/MapredLocalTask.java    |   3 +-
 .../ql/optimizer/physical/BucketingSortingCtx.java |  21 ++-
 .../physical/CommonJoinTaskDispatcher.java         |   2 -
 .../optimizer/physical/GenMRSkewJoinProcessor.java |   2 -
 .../physical/LocalMapJoinProcFactory.java          |   3 +-
 .../physical/SortMergeJoinTaskDispatcher.java      |   3 -
 .../apache/hadoop/hive/ql/parse/QBJoinTree.java    |   8 +-
 .../hive/ql/plan/ExprNodeGenericFuncDesc.java      |   2 +-
 .../org/apache/hadoop/hive/ql/plan/MapWork.java    |  10 +-
 .../org/apache/hadoop/hive/ql/plan/MapredWork.java |   2 -
 .../org/apache/hadoop/hive/ql/plan/PTFDesc.java    |   2 +-
 .../apache/hadoop/hive/ql/plan/PartitionDesc.java  |   2 +-
 .../hive/ql/udf/generic/GenericUDAFnGrams.java     |  14 +-
 .../hive/ql/udf/generic/GenericUDFArray.java       |   4 +-
 .../hive/ql/udf/generic/GenericUDFBridge.java      |  31 ++--
 .../ql/udf/generic/GenericUDFFormatNumber.java     |   8 +-
 .../hive/ql/udf/generic/GenericUDFIndex.java       |   8 +-
 .../hive/ql/udf/generic/GenericUDFNamedStruct.java |   2 +-
 .../hive/ql/udf/generic/GenericUDFStruct.java      |   2 +-
 .../ql/udf/generic/GenericUDFToUnixTimeStamp.java  |   2 +-
 .../hive/ql/udf/generic/GenericUDTFExplode.java    |   4 +-
 .../hive/ql/udf/generic/GenericUDTFJSONTuple.java  |   7 +-
 .../ql/udf/generic/GenericUDTFParseUrlTuple.java   |  37 ++--
 .../hive/ql/udf/generic/GenericUDTFStack.java      |   2 +-
 .../test/org/apache/hadoop/hive/ql/QTestUtil.java  |  56 +++---
 .../org/apache/hadoop/hive/ql/exec/TestPlan.java   |   7 +-
 .../results/compiler/plan/case_sensitivity.q.xml   |  36 ++++
 ql/src/test/results/compiler/plan/cast1.q.xml      |  78 ++++++---
 ql/src/test/results/compiler/plan/groupby1.q.xml   |  45 ++++-
 ql/src/test/results/compiler/plan/groupby2.q.xml   |  75 ++++++--
 ql/src/test/results/compiler/plan/groupby3.q.xml   | 111 ++++++++++--
 ql/src/test/results/compiler/plan/groupby4.q.xml   |  30 +++-
 ql/src/test/results/compiler/plan/groupby5.q.xml   |  45 ++++-
 ql/src/test/results/compiler/plan/groupby6.q.xml   |  30 +++-
 ql/src/test/results/compiler/plan/input1.q.xml     |  24 +++
 ql/src/test/results/compiler/plan/input2.q.xml     |  48 +++++
 ql/src/test/results/compiler/plan/input20.q.xml    |  54 +++++-
 ql/src/test/results/compiler/plan/input3.q.xml     |  54 ++++++
 ql/src/test/results/compiler/plan/input4.q.xml     |  42 +++++
 ql/src/test/results/compiler/plan/input5.q.xml     |  54 ++++++
 ql/src/test/results/compiler/plan/input6.q.xml     |  24 +++
 ql/src/test/results/compiler/plan/input7.q.xml     |  24 +++
 ql/src/test/results/compiler/plan/input8.q.xml     |  39 ++++-
 ql/src/test/results/compiler/plan/input9.q.xml     |  24 +++
 .../test/results/compiler/plan/input_part1.q.xml   |  42 +++++
 .../compiler/plan/input_testsequencefile.q.xml     |  24 +++
 .../results/compiler/plan/input_testxpath.q.xml    |  42 +++++
 .../results/compiler/plan/input_testxpath2.q.xml   |  42 +++++
 ql/src/test/results/compiler/plan/join1.q.xml      |  51 ++++++
 ql/src/test/results/compiler/plan/join2.q.xml      |  78 ++++++++-
 ql/src/test/results/compiler/plan/join3.q.xml      |  66 +++++++
 ql/src/test/results/compiler/plan/join4.q.xml      |  84 +++++++++
 ql/src/test/results/compiler/plan/join5.q.xml      |  84 +++++++++
 ql/src/test/results/compiler/plan/join6.q.xml      |  84 +++++++++
 ql/src/test/results/compiler/plan/join7.q.xml      | 126 +++++++++++++
 ql/src/test/results/compiler/plan/join8.q.xml      |  84 +++++++++
 ql/src/test/results/compiler/plan/sample1.q.xml    |  51 +++++-
 ql/src/test/results/compiler/plan/sample2.q.xml    |  30 +++-
 ql/src/test/results/compiler/plan/sample3.q.xml    |  30 +++-
 ql/src/test/results/compiler/plan/sample4.q.xml    |  30 +++-
 ql/src/test/results/compiler/plan/sample5.q.xml    |  30 +++-
 ql/src/test/results/compiler/plan/sample6.q.xml    |  30 +++-
 ql/src/test/results/compiler/plan/sample7.q.xml    |  30 +++-
 ql/src/test/results/compiler/plan/subq.q.xml       |  24 +++
 ql/src/test/results/compiler/plan/udf1.q.xml       | 165 +++++++++++------
 ql/src/test/results/compiler/plan/udf4.q.xml       | 195 +++++++++++++--------
 ql/src/test/results/compiler/plan/udf6.q.xml       |  24 +++
 ql/src/test/results/compiler/plan/udf_case.q.xml   |  24 +++
 ql/src/test/results/compiler/plan/udf_when.q.xml   |  24 +++
 ql/src/test/results/compiler/plan/union.q.xml      |  54 ++++++
 91 files changed, 2445 insertions(+), 430 deletions(-)

diff --git a/.gitignore b/.gitignore
index c0e9b3c..a7b07b9 100644
--- a/.gitignore
+++ b/.gitignore
@@ -17,3 +17,4 @@ ql/derby.log
 derby.log
 .arc
 ql/TempStatsStore
+patches
diff --git a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
index 7dcce04..8c42bd7 100644
--- a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
+++ b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
@@ -177,6 +177,7 @@
     // QL execution stuff
     SCRIPTWRAPPER("hive.exec.script.wrapper", null),
     PLAN("hive.exec.plan", ""),
+    PLAN_SERIALIZATION("hive.plan.serialization.format","kryo"),
     SCRATCHDIR("hive.exec.scratchdir", "/tmp/hive-" + System.getProperty("user.name")),
     LOCALSCRATCHDIR("hive.exec.local.scratchdir", System.getProperty("java.io.tmpdir") + File.separator + System.getProperty("user.name")),
     SCRATCHDIRPERMISSION("hive.scratch.dir.permission", "700"),
diff --git a/conf/hive-default.xml.template b/conf/hive-default.xml.template
index e445cd4..2d25d69 100644
--- a/conf/hive-default.xml.template
+++ b/conf/hive-default.xml.template
@@ -2020,4 +2020,13 @@
 </property>
 
 
+<property>
+  <name>hive.plan.serialization.format</name>
+  <value>kryo</value>
+  <description>
+  Query plan format serialization between client and task nodes. 
+  Two supported values are : kryo and javaXML. Kryo is default.
+  </description>
+</property>
+
 </configuration>
diff --git a/contrib/src/java/org/apache/hadoop/hive/contrib/udtf/example/GenericUDTFCount2.java b/contrib/src/java/org/apache/hadoop/hive/contrib/udtf/example/GenericUDTFCount2.java
index 0bd788e..032322a 100644
--- a/contrib/src/java/org/apache/hadoop/hive/contrib/udtf/example/GenericUDTFCount2.java
+++ b/contrib/src/java/org/apache/hadoop/hive/contrib/udtf/example/GenericUDTFCount2.java
@@ -36,8 +36,8 @@
  */
 public class GenericUDTFCount2 extends GenericUDTF {
 
-  Integer count = Integer.valueOf(0);
-  Object forwardObj[] = new Object[1];
+  private transient Integer count = Integer.valueOf(0);
+  private transient Object forwardObj[] = new Object[1];
 
   @Override
   public void close() throws HiveException {
diff --git a/contrib/src/java/org/apache/hadoop/hive/contrib/udtf/example/GenericUDTFExplode2.java b/contrib/src/java/org/apache/hadoop/hive/contrib/udtf/example/GenericUDTFExplode2.java
index da5ae9c..a4dd152 100644
--- a/contrib/src/java/org/apache/hadoop/hive/contrib/udtf/example/GenericUDTFExplode2.java
+++ b/contrib/src/java/org/apache/hadoop/hive/contrib/udtf/example/GenericUDTFExplode2.java
@@ -67,7 +67,7 @@ public StructObjectInspector initialize(ObjectInspector[] args)
         fieldOIs);
   }
 
-  Object forwardObj[] = new Object[2];
+  private transient Object forwardObj[] = new Object[2];
 
   @Override
   public void process(Object[] o) throws HiveException {
diff --git a/hcatalog/pom.xml b/hcatalog/pom.xml
index 499e8c9..6889f21 100644
--- a/hcatalog/pom.xml
+++ b/hcatalog/pom.xml
@@ -215,7 +215,16 @@
         <enabled>false</enabled>
       </snapshots>
     </repository>
-
+    <repository>
+      <id>sonatype-snapshots</id>
+      <url>https://oss.sonatype.org/content/repositories/snapshots/</url>
+      <releases>
+        <enabled>false</enabled>
+      </releases>
+      <snapshots>
+        <enabled>true</enabled>
+      </snapshots>
+    </repository>
   </repositories>
 
     <dependencies>
diff --git a/ivy/ivysettings.xml b/ivy/ivysettings.xml
index d230f2c..51ce5ac 100644
--- a/ivy/ivysettings.xml
+++ b/ivy/ivysettings.xml
@@ -47,6 +47,10 @@
              checkmodified="${ivy.checkmodified}" 
              changingPattern="${ivy.changingPattern}"/>
 
+    <ibiblio name="sonatype-snapshot" root="https://oss.sonatype.org/content/repositories/snapshots/" m2compatible="true"
+             checkmodified="${ivy.checkmodified}" 
+             changingPattern="${ivy.changingPattern}"/>
+
     <url name="datanucleus-repo" m2compatible="true">
       <artifact pattern="${datanucleus.repo}/[organisation]/[module]/[revision]/[module]-[revision](-[classifier]).[ext]"/>
     </url>
@@ -68,6 +72,7 @@
       <resolver ref="maven2"/>
       <resolver ref="datanucleus-repo"/>
       <resolver ref="sourceforge"/>
+      <resolver ref="sonatype-snapshot"/>
     </chain>
 
     <chain name="internal" dual="true">
@@ -77,11 +82,13 @@
       <resolver ref="maven2"/>
       <resolver ref="datanucleus-repo"/>
       <resolver ref="sourceforge"/>
+      <resolver ref="sonatype-snapshot"/>
     </chain>
 
     <chain name="external">
       <resolver ref="maven2"/>
       <resolver ref="datanucleus-repo"/>
+      <resolver ref="sonatype-snapshot"/>
     </chain>
 
   </resolvers>
diff --git a/ivy/libraries.properties b/ivy/libraries.properties
index 92ba790..eb912ba 100644
--- a/ivy/libraries.properties
+++ b/ivy/libraries.properties
@@ -53,6 +53,7 @@ jetty.version=6.1.26
 jline.version=0.9.94
 json.version=20090211
 junit.version=4.10
+kryo.version=2.23-SNAPSHOT
 libfb303.version=0.9.0
 libthrift.version=0.9.0
 log4j.version=1.2.16
diff --git a/ql/build.xml b/ql/build.xml
index 64e7b59..ac2b7b0 100644
--- a/ql/build.xml
+++ b/ql/build.xml
@@ -250,6 +250,15 @@
         <exclude name="META-INF/MANIFEST.MF"/>
       </patternset>
     </unzip>
+     <unzip 
+      src="${build.ivy.lib.dir}/default/kryo-${kryo.version}.jar" 
+      dest="${build.dir.hive}/kryo/classes">
+      <patternset>
+        <exclude name="META-INF"/>
+        <exclude name="META-INF/MANIFEST.MF"/>
+      </patternset>
+    </unzip>
+
     <unzip
       src="${build.ivy.lib.dir}/default/protobuf-java-${protobuf.version}.jar"
       dest="${build.dir.hive}/protobuf-java/classes">
@@ -298,7 +307,9 @@
       <fileset dir="${build.dir.hive}/ql/classes" includes="**/*.class,**/*.properties"/>
       <fileset dir="${build.dir.hive}/serde/classes" includes="**/*.class"/>
       <fileset dir="${build.dir.hive}/thrift/classes" includes="**/*.class"/>
-      <fileset dir="${build.dir.hive}/commons-lang/classes" includes="**/StringUtils.class,**/WordUtils.class"/>
+     
+      <fileset dir="${build.dir.hive}/kryo/classes" includes="**/*.class"/>
+ <fileset dir="${build.dir.hive}/commons-lang/classes" includes="**/StringUtils.class,**/WordUtils.class"/>
       <fileset dir="${build.dir.hive}/json/classes" includes="**/*.class"/>
       <fileset dir="${build.dir.hive}/avro/classes" includes="**/*.class"/>
       <fileset dir="${build.dir.hive}/avro-mapred/classes" includes="**/*.class"/>
diff --git a/ql/ivy.xml b/ql/ivy.xml
index 08a8d6f..df07f4e 100644
--- a/ql/ivy.xml
+++ b/ql/ivy.xml
@@ -46,6 +46,8 @@
                 rev="${protobuf.version}" transitive="false"/>
     <dependency org="org.iq80.snappy" name="snappy" 
                 rev="${snappy.version}" transitive="false"/>
+    <dependency org="com.esotericsoftware.kryo" name="kryo" 
+                rev="${kryo.version}" />
 
     <dependency org="org.json" name="json" rev="${json.version}"/>
     <dependency org="commons-collections" name="commons-collections" rev="${commons-collections.version}"/>
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
index 05b5c4d..d17b265 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
@@ -465,12 +465,12 @@ public int compile(String command, boolean resetTaskIds) {
 
         // serialize the queryPlan
         FileOutputStream fos = new FileOutputStream(queryPlanFileName);
-        Utilities.serializeObject(plan, fos);
+        Utilities.serializePlan(plan, fos, conf);
         fos.close();
 
         // deserialize the queryPlan
         FileInputStream fis = new FileInputStream(queryPlanFileName);
-        QueryPlan newPlan = Utilities.deserializeObject(fis);
+        QueryPlan newPlan = Utilities.deserializePlan(fis, QueryPlan.class, conf);
         fis.close();
 
         // Use the deserialized plan
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ColumnInfo.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ColumnInfo.java
index ee44051..44065ff 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ColumnInfo.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ColumnInfo.java
@@ -58,6 +58,8 @@
 
   private boolean isHiddenVirtualCol;
 
+  private String typeName;
+
   public ColumnInfo() {
   }
 
@@ -94,6 +96,7 @@ public ColumnInfo(String internalName, ObjectInspector objectInspector,
     this.tabAlias = tabAlias;
     this.isVirtualCol = isVirtualCol;
     this.isHiddenVirtualCol = isHiddenVirtualCol;
+    this.typeName = getType().getTypeName();
   }
 
   public ColumnInfo(ColumnInfo columnInfo) {
@@ -104,6 +107,15 @@ public ColumnInfo(ColumnInfo columnInfo) {
     this.isVirtualCol = columnInfo.getIsVirtualCol();
     this.isHiddenVirtualCol = columnInfo.isHiddenVirtualCol();
     this.setType(columnInfo.getType());
+    this.typeName = columnInfo.getType().getTypeName();
+  }
+
+  public String getTypeName() {
+    return this.typeName;
+  }
+
+  public void setTypeName(String typeName) {
+    this.typeName = typeName;
   }
 
   public TypeInfo getType() {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeColumnEvaluator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeColumnEvaluator.java
index 3f1e001..24c8281 100755
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeColumnEvaluator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeColumnEvaluator.java
@@ -31,12 +31,12 @@
  */
 public class ExprNodeColumnEvaluator extends ExprNodeEvaluator<ExprNodeColumnDesc> {
 
-  transient boolean simpleCase;
-  transient StructObjectInspector inspector;
-  transient StructField field;
-  transient StructObjectInspector[] inspectors;
-  transient StructField[] fields;
-  transient boolean[] unionField;
+  private transient boolean simpleCase;
+  private transient StructObjectInspector inspector;
+  private transient StructField field;
+  private transient StructObjectInspector[] inspectors;
+  private transient StructField[] fields;
+  private transient boolean[] unionField;
 
   public ExprNodeColumnEvaluator(ExprNodeColumnDesc expr) {
     super(expr);
@@ -61,18 +61,17 @@ public ObjectInspector initialize(ObjectInspector rowInspector) throws HiveExcep
     fields = new StructField[names.length];
     unionField = new boolean[names.length];
     int unionIndex = -1;
-
     for (int i = 0; i < names.length; i++) {
       if (i == 0) {
         inspectors[0] = (StructObjectInspector) rowInspector;
       } else {
-        if (unionIndex != -1) {
+        if (unionIndex == -1) {
+          inspectors[i] = (StructObjectInspector) fields[i - 1]
+              .getFieldObjectInspector();
+        } else {
           inspectors[i] = (StructObjectInspector) (
               (UnionObjectInspector)fields[i-1].getFieldObjectInspector()).
               getObjectInspectors().get(unionIndex);
-        } else {
-          inspectors[i] = (StructObjectInspector) fields[i - 1]
-              .getFieldObjectInspector();
         }
       }
       // to support names like _colx:1._coly
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
index 30df771..ffd2149 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
@@ -484,7 +484,7 @@ public static void registerUDF(boolean isNative, String functionName,
       Class<? extends UDF> UDFClass, boolean isOperator, String displayName) {
     if (UDF.class.isAssignableFrom(UDFClass)) {
       FunctionInfo fI = new FunctionInfo(isNative, displayName,
-          new GenericUDFBridge(displayName, isOperator, UDFClass));
+          new GenericUDFBridge(displayName, isOperator, UDFClass.getName()));
       mFunctions.put(functionName.toLowerCase(), fI);
     } else {
       throw new RuntimeException("Registering UDF Class " + UDFClass
@@ -1308,7 +1308,7 @@ public static GenericUDF cloneGenericUDF(GenericUDF genericUDF) {
     if (genericUDF instanceof GenericUDFBridge) {
       GenericUDFBridge bridge = (GenericUDFBridge) genericUDF;
       clonedUDF = new GenericUDFBridge(bridge.getUdfName(), bridge.isOperator(),
-          bridge.getUdfClass());
+          bridge.getUdfClassName());
     } else if (genericUDF instanceof GenericUDFMacro) {
       GenericUDFMacro bridge = (GenericUDFMacro) genericUDF;
       clonedUDF = new GenericUDFMacro(bridge.getMacroName(), bridge.getBody(),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableDummyOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableDummyOperator.java
index 70cbff8..e00b7d3 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableDummyOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableDummyOperator.java
@@ -38,7 +38,7 @@ protected void initializeOp(Configuration hconf) throws HiveException {
       this.outputObjInspector = serde.getObjectInspector();
       initializeChildren(hconf);
     } catch (Exception e) {
-      LOG.error("Generating output obj inspector from dummy object error");
+      LOG.error("Generating output obj inspector from dummy object error", e);
       e.printStackTrace();
     }
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
index 50580f4..fa3ad8f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
@@ -58,7 +58,7 @@
 
   private static final long serialVersionUID = 1L;
 
-  private Configuration configuration;
+  private transient Configuration configuration;
   protected List<Operator<? extends OperatorDesc>> childOperators;
   protected List<Operator<? extends OperatorDesc>> parentOperators;
   protected String operatorId;
@@ -196,7 +196,7 @@ public void setDone(boolean done) {
   }
 
   // non-bean fields needed during compilation
-  private transient RowSchema rowSchema;
+  private RowSchema rowSchema;
 
   public void setSchema(RowSchema rowSchema) {
     this.rowSchema = rowSchema;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/RowSchema.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/RowSchema.java
index 234bbcd..1bfcee6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/RowSchema.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/RowSchema.java
@@ -51,8 +51,10 @@ public void setSignature(ArrayList<ColumnInfo> signature) {
   @Override
   public String toString() {
     StringBuilder sb = new StringBuilder('(');
-    for (ColumnInfo col: signature) {
-      sb.append(col.toString());
+    if (signature != null) {
+      for (ColumnInfo col : signature) {
+        sb.append(col.toString());
+      }
     }
     sb.append(')');
     return sb.toString();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
index 776b3b2..7f7520b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
@@ -103,6 +103,8 @@
 import org.apache.hadoop.hive.ql.QueryPlan;
 import org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter;
 import org.apache.hadoop.hive.ql.exec.mr.ExecDriver;
+import org.apache.hadoop.hive.ql.exec.mr.ExecMapper;
+import org.apache.hadoop.hive.ql.exec.mr.ExecReducer;
 import org.apache.hadoop.hive.ql.exec.mr.MapRedTask;
 import org.apache.hadoop.hive.ql.io.ContentSummaryInputFormat;
 import org.apache.hadoop.hive.ql.io.HiveFileFormatUtils;
@@ -113,6 +115,12 @@
 import org.apache.hadoop.hive.ql.io.OneNullRowInputFormat;
 import org.apache.hadoop.hive.ql.io.RCFile;
 import org.apache.hadoop.hive.ql.io.ReworkMapredInputFormat;
+import org.apache.hadoop.hive.ql.io.rcfile.merge.MergeWork;
+import org.apache.hadoop.hive.ql.io.rcfile.merge.RCFileMergeMapper;
+import org.apache.hadoop.hive.ql.io.rcfile.stats.PartialScanMapper;
+import org.apache.hadoop.hive.ql.io.rcfile.stats.PartialScanWork;
+import org.apache.hadoop.hive.ql.io.rcfile.truncate.ColumnTruncateMapper;
+import org.apache.hadoop.hive.ql.io.rcfile.truncate.ColumnTruncateWork;
 import org.apache.hadoop.hive.ql.log.PerfLogger;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.metadata.Partition;
@@ -167,6 +175,10 @@
 import org.apache.hadoop.util.ReflectionUtils;
 import org.apache.hadoop.util.Shell;
 
+import com.esotericsoftware.kryo.Kryo;
+import com.esotericsoftware.kryo.io.Input;
+import com.esotericsoftware.kryo.io.Output;
+
 /**
  * Utilities.
  *
@@ -254,7 +266,7 @@ public static ReduceWork getReduceWork(Configuration conf) {
     return (ReduceWork) getBaseWork(conf, REDUCE_PLAN_NAME);
   }
 
-  public static BaseWork getBaseWork(Configuration conf, String name) {
+  private static BaseWork getBaseWork(Configuration conf, String name) {
     BaseWork gWork = null;
     Path path = null;
     try {
@@ -269,8 +281,25 @@ public static BaseWork getBaseWork(Configuration conf, String name) {
           localPath = new Path(name);
         }
         InputStream in = new FileInputStream(localPath.toUri().getPath());
-        BaseWork ret = deserializePlan(in);
-        gWork = ret;
+        if(MAP_PLAN_NAME.equals(name)){
+          if (ExecMapper.class.getName().equals(conf.get("mapred.mapper.class"))){
+            gWork = deserializePlan(in, MapWork.class, conf);
+          } else if(RCFileMergeMapper.class.getName().equals(conf.get("mapred.mapper.class"))) {
+            gWork = deserializePlan(in, MergeWork.class, conf);
+          } else if(ColumnTruncateMapper.class.getName().equals(conf.get("mapred.mapper.class"))) {
+            gWork = deserializePlan(in, ColumnTruncateWork.class, conf);
+          } else if(PartialScanMapper.class.getName().equals(conf.get("mapred.mapper.class"))) {
+            gWork = deserializePlan(in, PartialScanWork.class,conf);
+          } else {
+            assert false;
+          }
+        } else {
+          if(ExecReducer.class.getName().equals(conf.get("mapred.reducer.class"))) {
+            gWork = deserializePlan(in, ReduceWork.class, conf);
+          } else {
+            assert false;
+          }
+        }
         gWorkMap.put(path, gWork);
       }
       return gWork;
@@ -492,7 +521,7 @@ private static Path setBaseWork(Configuration conf, BaseWork w, String hiveScrat
       // use the default file system of the conf
       FileSystem fs = planPath.getFileSystem(conf);
       FSDataOutputStream out = fs.create(planPath);
-      serializePlan(w, out);
+      serializePlan(w, out, conf);
 
       // Serialize the plan to the default hdfs instance
       // Except for hadoop local mode execution where we should be
@@ -599,15 +628,38 @@ protected void initialize(Class type, Object oldInstance, Object newInstance, En
     }
   }
 
+   /** Custom Kryo serializer for sql date, otherwise Kryo gets confused between
+   java.sql.Date and java.util.Date while deserializing
+   */
+  private static class SqlDateSerializer extends
+    com.esotericsoftware.kryo.Serializer<java.sql.Date> {
+
+    @Override
+    public java.sql.Date read(Kryo kryo, Input input, Class<java.sql.Date> clazz) {
+      return new java.sql.Date(input.readLong());
+    }
+
+    @Override
+    public void write(Kryo kryo, Output output, java.sql.Date sqlDate) {
+      output.writeLong(sqlDate.getTime());
+    }
+
+  }
+
   /**
    * Serializes the plan.
    * @param plan The plan, such as QueryPlan, MapredWork, etc.
    * @param out The stream to write to.
+   * @param conf to pick which serialization format is desired.
    */
-  public static void serializePlan(Object plan, OutputStream out) {
+  public static void serializePlan(Object plan, OutputStream out, Configuration conf) {
     PerfLogger perfLogger = PerfLogger.getPerfLogger();
     perfLogger.PerfLogBegin(LOG, PerfLogger.SERIALIZE_PLAN);
-    serializeObject(plan, out);
+    if(conf.get(HiveConf.ConfVars.PLAN_SERIALIZATION.varname, "kryo").equals("javaXML")) {
+      serializeObjectByJavaXML(plan, out);
+    } else {
+      serializeObjectByKryo(plan, out);
+    }
     perfLogger.PerfLogEnd(LOG, PerfLogger.SERIALIZE_PLAN);
   }
 
@@ -615,13 +667,19 @@ public static void serializePlan(Object plan, OutputStream out) {
    * Deserializes the plan.
    * @param in The stream to read from.
    * @return The plan, such as QueryPlan, MapredWork, etc.
+   * @param To know what serialization format plan is in
    */
-  public static <T> T deserializePlan(InputStream in) {
+  public static <T> T deserializePlan(InputStream in, Class<T> planClass, Configuration conf) {
     PerfLogger perfLogger = PerfLogger.getPerfLogger();
     perfLogger.PerfLogBegin(LOG, PerfLogger.DESERIALIZE_PLAN);
-    T result = deserializeObject(in);
+    T plan;
+    if(conf.get(HiveConf.ConfVars.PLAN_SERIALIZATION.varname, "kryo").equals("javaXML")) {
+      plan = deserializeObjectByJavaXML(in);
+    } else {
+      plan = deserializeObjectByKryo(in, planClass);
+    }
     perfLogger.PerfLogEnd(LOG, PerfLogger.DESERIALIZE_PLAN);
-    return result;
+    return plan;
   }
 
   /**
@@ -629,22 +687,23 @@ public static void serializePlan(Object plan, OutputStream out) {
    * @param plan The plan.
    * @return The clone.
    */
-  public static <T> T clonePlan(T plan) {
-    // TODO: need proper clone. Meanwhiel, let's at least keep this horror in one place
+  public static MapredWork clonePlan(MapredWork plan) {
+    // TODO: need proper clone. Meanwhile, let's at least keep this horror in one place
     PerfLogger perfLogger = PerfLogger.getPerfLogger();
     perfLogger.PerfLogBegin(LOG, PerfLogger.CLONE_PLAN);
     ByteArrayOutputStream baos = new ByteArrayOutputStream();
-    Utilities.serializeObject(plan, baos);
-    T copy = Utilities.deserializeObject(new ByteArrayInputStream(baos.toByteArray()));
+    Utilities.serializeObjectByJavaXML(plan, baos);
+    MapredWork newPlan = Utilities.deserializeObjectByJavaXML(
+      new ByteArrayInputStream(baos.toByteArray()));
     perfLogger.PerfLogEnd(LOG, PerfLogger.CLONE_PLAN);
-    return copy;
+    return newPlan;
   }
 
   /**
    * Serialize the object. This helper function mainly makes sure that enums,
    * counters, etc are handled properly.
    */
-  public static void serializeObject(Object plan, OutputStream out) {
+  private static void serializeObjectByJavaXML(Object plan, OutputStream out) {
     XMLEncoder e = new XMLEncoder(out);
     e.setExceptionListener(new ExceptionListener() {
       public void exceptionThrown(Exception e) {
@@ -668,11 +727,21 @@ public void exceptionThrown(Exception e) {
   }
 
   /**
+   * @param plan Usually of type MapredWork, MapredLocalWork etc.
+   * @param out stream in which serialized plan is written into
+   */
+  private static void serializeObjectByKryo(Object plan, OutputStream out) {
+    Output output = new Output(out);
+    kryo.get().writeObject(output, plan);
+    output.close();
+  }
+
+  /**
    * De-serialize an object. This helper function mainly makes sure that enums,
    * counters, etc are handled properly.
    */
   @SuppressWarnings("unchecked")
-  public static <T> T deserializeObject(InputStream in) {
+  private static <T> T deserializeObjectByJavaXML(InputStream in) {
     XMLDecoder d = null;
     try {
       d = new XMLDecoder(in, null, null);
@@ -684,6 +753,27 @@ public void exceptionThrown(Exception e) {
     }
   }
 
+  private static <T> T deserializeObjectByKryo(InputStream in, Class<T> clazz ) {
+    Input inp = new Input(in);
+    T t = kryo.get().readObject(inp,clazz);
+    inp.close();
+    return t;
+  }
+
+  // Kryo is not thread-safe,
+  // Also new Kryo() is expensive, so we want to do it just once.
+  private static ThreadLocal<Kryo> kryo = new ThreadLocal<Kryo>() {
+
+    @Override
+    protected synchronized Kryo initialValue() {
+      Kryo kryo = new Kryo();
+      kryo.setClassLoader(Thread.currentThread().getContextClassLoader());
+      kryo.register(java.sql.Date.class, new SqlDateSerializer());
+      return kryo;
+    };
+  };
+
+
   public static TableDesc defaultTd;
   static {
     // by default we expect ^A separated strings
@@ -2148,7 +2238,7 @@ public static void setColumnTypeList(JobConf jobConf, Operator op) {
       if (columnTypes.length() > 0) {
         columnTypes.append(",");
       }
-      columnTypes.append(colInfo.getType().getTypeName());
+      columnTypes.append(colInfo.getTypeName());
     }
     String columnTypesString = columnTypes.toString();
     jobConf.set(serdeConstants.LIST_COLUMN_TYPES, columnTypesString);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecDriver.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecDriver.java
index 867f252..cde76bf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecDriver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecDriver.java
@@ -717,12 +717,12 @@ public static void main(String[] args) throws IOException, HiveException {
     int ret;
     if (localtask) {
       memoryMXBean = ManagementFactory.getMemoryMXBean();
-      MapredLocalWork plan = (MapredLocalWork) Utilities.deserializePlan(pathData);
+      MapredLocalWork plan = Utilities.deserializePlan(pathData, MapredLocalWork.class, conf);
       MapredLocalTask ed = new MapredLocalTask(plan, conf, isSilent);
       ret = ed.executeFromChildJVM(new DriverContext());
 
     } else {
-      MapredWork plan = (MapredWork) Utilities.deserializePlan(pathData);
+      MapredWork plan = Utilities.deserializePlan(pathData, MapredWork.class, conf);
       ExecDriver ed = new ExecDriver(plan, conf, isSilent);
       ret = ed.execute(new DriverContext());
     }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HadoopJobExecHelper.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HadoopJobExecHelper.java
index cd872b2..b0e6ef3 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HadoopJobExecHelper.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HadoopJobExecHelper.java
@@ -35,10 +35,10 @@
 import org.apache.hadoop.hive.common.JavaUtils;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.ql.MapRedStats;
+import org.apache.hadoop.hive.ql.exec.Operator.ProgressCounter;
 import org.apache.hadoop.hive.ql.exec.Task;
 import org.apache.hadoop.hive.ql.exec.TaskHandle;
 import org.apache.hadoop.hive.ql.exec.Utilities;
-import org.apache.hadoop.hive.ql.exec.Operator.ProgressCounter;
 import org.apache.hadoop.hive.ql.history.HiveHistory.Keys;
 import org.apache.hadoop.hive.ql.plan.ReducerTimeStatsPerJob;
 import org.apache.hadoop.hive.ql.session.SessionState;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapRedTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapRedTask.java
index 08bc0a1..fdf1629 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapRedTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapRedTask.java
@@ -39,14 +39,11 @@
 import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.exec.Utilities.StreamPrinter;
-import org.apache.hadoop.hive.ql.metadata.HiveException;
-import org.apache.hadoop.hive.ql.plan.MapWork;
 import org.apache.hadoop.hive.ql.plan.MapredWork;
 import org.apache.hadoop.hive.ql.plan.OperatorDesc;
 import org.apache.hadoop.hive.ql.plan.ReduceWork;
 import org.apache.hadoop.hive.ql.session.SessionState;
 import org.apache.hadoop.hive.shims.ShimLoader;
-import org.apache.hadoop.mapred.JobConf;
 /**
  * Extension of ExecDriver:
  * - can optionally spawn a map-reduce task from a separate jvm
@@ -69,7 +66,6 @@
   private transient ContentSummary inputSummary = null;
   private transient boolean runningViaChild = false;
 
-  private transient boolean inputSizeEstimated = false;
   private transient long totalInputFileSize;
   private transient long totalInputNumFiles;
 
@@ -79,10 +75,6 @@ public MapRedTask() {
     super();
   }
 
-  public MapRedTask(MapredWork plan, JobConf job, boolean isSilent) throws HiveException {
-    throw new RuntimeException("Illegal Constructor call");
-  }
-
   @Override
   public int execute(DriverContext driverContext) {
 
@@ -181,7 +173,7 @@ public int execute(DriverContext driverContext) {
       OutputStream out = FileSystem.getLocal(conf).create(planPath);
       MapredWork plan = getWork();
       LOG.info("Generating plan file " + planPath.toString());
-      Utilities.serializePlan(plan, out);
+      Utilities.serializePlan(plan, out, conf);
 
       String isSilent = "true".equalsIgnoreCase(System
           .getProperty("test.silent")) ? "-nolog" : "";
@@ -408,7 +400,7 @@ private void setNumberOfReducers() throws IOException {
         if (inputSummary == null) {
           inputSummary =  Utilities.getInputSummary(driverContext.getCtx(), work.getMapWork(), null);
         }
-        int reducers = Utilities.estimateNumberOfReducers(conf, inputSummary, work.getMapWork(), 
+        int reducers = Utilities.estimateNumberOfReducers(conf, inputSummary, work.getMapWork(),
                                                           work.isFinalMapRed());
         rWork.setNumReduceTasks(reducers);
         console
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapredLocalTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapredLocalTask.java
index f7fff9a..96f6a8c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapredLocalTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapredLocalTask.java
@@ -134,14 +134,13 @@ public int execute(DriverContext driverContext) {
       String hiveJar = conf.getJar();
 
       String hadoopExec = conf.getVar(HiveConf.ConfVars.HADOOPBIN);
-      String libJarsOption;
 
       // write out the plan to a local file
       Path planPath = new Path(ctx.getLocalTmpFileURI(), "plan.xml");
       OutputStream out = FileSystem.getLocal(conf).create(planPath);
       MapredLocalWork plan = getWork();
       LOG.info("Generating plan file " + planPath.toString());
-      Utilities.serializePlan(plan, out);
+      Utilities.serializePlan(plan, out, conf);
 
       String isSilent = "true".equalsIgnoreCase(System.getProperty("test.silent")) ? "-nolog" : "";
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/BucketingSortingCtx.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/BucketingSortingCtx.java
index c8354ff..296fecb 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/BucketingSortingCtx.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/BucketingSortingCtx.java
@@ -36,19 +36,19 @@
  */
 public class BucketingSortingCtx implements NodeProcessorCtx {
 
-  boolean disableBucketing;
+  private boolean disableBucketing;
 
   // A mapping from an operator to the columns by which it's output is bucketed
-  Map<Operator<? extends OperatorDesc>, List<BucketCol>> bucketedColsByOp;
+  private Map<Operator<? extends OperatorDesc>, List<BucketCol>> bucketedColsByOp;
   // A mapping from a directory which a FileSinkOperator writes into to the columns by which that
   // output is bucketed
-  Map<String, List<BucketCol>> bucketedColsByDirectory;
+  private Map<String, List<BucketCol>> bucketedColsByDirectory;
 
   // A mapping from an operator to the columns by which it's output is sorted
-  Map<Operator<? extends OperatorDesc>, List<SortCol>> sortedColsByOp;
+  private Map<Operator<? extends OperatorDesc>, List<SortCol>> sortedColsByOp;
   // A mapping from a directory which a FileSinkOperator writes into to the columns by which that
   // output is sorted
-  Map<String, List<SortCol>> sortedColsByDirectory;
+  private Map<String, List<SortCol>> sortedColsByDirectory;
 
   public BucketingSortingCtx(boolean disableBucketing) {
     this.disableBucketing = disableBucketing;
@@ -189,13 +189,18 @@ public String toString() {
    * to be constant for all equivalent columns.
    */
   public static final class SortCol implements BucketSortCol, Serializable {
+
+    public SortCol() {
+      super();
+    }
+
     private static final long serialVersionUID = 1L;
     // Equivalent aliases for the column
-    private final List<String> names = new ArrayList<String>();
+    private List<String> names = new ArrayList<String>();
     // Indexes of those equivalent columns
-    private final List<Integer> indexes = new ArrayList<Integer>();
+    private List<Integer> indexes = new ArrayList<Integer>();
     // Sort order (+|-)
-    private final char sortOrder;
+    private char sortOrder;
 
     public SortCol(String name, int index, char sortOrder) {
       this(sortOrder);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinTaskDispatcher.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinTaskDispatcher.java
index c15a181..2efa7c2 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinTaskDispatcher.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinTaskDispatcher.java
@@ -17,8 +17,6 @@
  */
 package org.apache.hadoop.hive.ql.optimizer.physical;
 
-import java.io.ByteArrayInputStream;
-import java.io.InputStream;
 import java.io.Serializable;
 import java.io.UnsupportedEncodingException;
 import java.util.ArrayList;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java
index ed00003..48587ba 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java
@@ -18,9 +18,7 @@
 
 package org.apache.hadoop.hive.ql.optimizer.physical;
 
-import java.io.ByteArrayInputStream;
 import java.io.Serializable;
-import java.io.UnsupportedEncodingException;
 import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.LinkedHashMap;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/LocalMapJoinProcFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/LocalMapJoinProcFactory.java
index 85a2bdf..5a53e15 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/LocalMapJoinProcFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/LocalMapJoinProcFactory.java
@@ -163,7 +163,8 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx ctx, Object..
           if (parent instanceof TableScanOperator) {
             tbl = ((TableScanOperator) parent).getTableDesc();
           } else {
-            throw new SemanticException();
+            throw new SemanticException("Expected parent operator of type TableScanOperator." +
+              "Found " + parent.getClass().getName() + " instead.");
           }
         } else {
           // get parent schema
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SortMergeJoinTaskDispatcher.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SortMergeJoinTaskDispatcher.java
index 38a28f3..698b67b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SortMergeJoinTaskDispatcher.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SortMergeJoinTaskDispatcher.java
@@ -17,8 +17,6 @@
  */
 package org.apache.hadoop.hive.ql.optimizer.physical;
 
-import java.io.ByteArrayInputStream;
-import java.io.InputStream;
 import java.io.Serializable;
 import java.io.UnsupportedEncodingException;
 import java.util.ArrayList;
@@ -236,7 +234,6 @@ private boolean isEligibleForOptimization(SMBMapJoinOperator originalSMBJoinOp)
   public Task<? extends Serializable> processCurrentTask(MapRedTask currTask,
       ConditionalTask conditionalTask, Context context)
       throws SemanticException {
-
     // whether it contains a sort merge join operator
     MapredWork currWork = currTask.getWork();
     SMBMapJoinOperator originalSMBJoinOp = getSMBMapJoinOp(currWork);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/QBJoinTree.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/QBJoinTree.java
index 0aaf47e..9834e73 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/QBJoinTree.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/QBJoinTree.java
@@ -51,22 +51,22 @@
 
   // keeps track of the right-hand-side table name of the left-semi-join, and
   // its list of join keys
-  private final HashMap<String, ArrayList<ASTNode>> rhsSemijoin;
+  private transient final HashMap<String, ArrayList<ASTNode>> rhsSemijoin;
 
   // join conditions
-  private ArrayList<ArrayList<ASTNode>> expressions;
+  private transient ArrayList<ArrayList<ASTNode>> expressions;
 
   // key index to nullsafe join flag
   private ArrayList<Boolean> nullsafes;
 
   // filters
-  private ArrayList<ArrayList<ASTNode>> filters;
+  private transient ArrayList<ArrayList<ASTNode>> filters;
 
   // outerjoin-pos = other-pos:filter-len, other-pos:filter-len, ...
   private int[][] filterMap;
 
   // filters for pushing
-  private ArrayList<ArrayList<ASTNode>> filtersForPushing;
+  private transient ArrayList<ArrayList<ASTNode>> filtersForPushing;
 
   // user asked for map-side join
   private boolean mapSideJoin;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java
index eefc726..52fe47b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java
@@ -249,7 +249,7 @@ public boolean isSame(Object o) {
     if (genericUDF instanceof GenericUDFBridge) {
       GenericUDFBridge bridge = (GenericUDFBridge) genericUDF;
       GenericUDFBridge bridge2 = (GenericUDFBridge) dest.getGenericUDF();
-      if (!bridge.getUdfClass().equals(bridge2.getUdfClass())
+      if (!bridge.getUdfClassName().equals(bridge2.getUdfClassName())
           || !bridge.getUdfName().equals(bridge2.getUdfName())
           || bridge.isOperator() != bridge2.isOperator()) {
         return false;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapWork.java
index ff90bc8..b2c3b3f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapWork.java
@@ -52,13 +52,13 @@
  * distributed on the cluster. The ExecMapper will ultimately deserialize this
  * class on the data nodes and setup it's operator pipeline accordingly.
  *
- * This class is also used in the explain command any property with the 
+ * This class is also used in the explain command any property with the
  * appropriate annotation will be displayed in the explain output.
  */
 @SuppressWarnings({"serial", "deprecation"})
 public class MapWork extends BaseWork {
 
-  private static transient final Log LOG = LogFactory.getLog(MapWork.class);
+  private static final Log LOG = LogFactory.getLog(MapWork.class);
 
   private boolean hadoopSupportsSplittable;
 
@@ -102,15 +102,15 @@
   public static final int SAMPLING_ON_START = 2;    // sampling on task running
 
   // the following two are used for join processing
-  private QBJoinTree joinTree;
-  private LinkedHashMap<Operator<? extends OperatorDesc>, OpParseContext> opParseCtxMap;
+  private transient QBJoinTree joinTree;
+  private transient LinkedHashMap<Operator<? extends OperatorDesc>, OpParseContext> opParseCtxMap;
 
   private boolean mapperCannotSpanPartns;
 
   // used to indicate the input is sorted, and so a BinarySearchRecordReader shoudl be used
   private boolean inputFormatSorted = false;
 
-  private transient boolean useBucketizedHiveInputFormat;
+  private boolean useBucketizedHiveInputFormat;
 
   public MapWork() {
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java
index 23cd4e8..f3203bf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java
@@ -18,12 +18,10 @@
 
 package org.apache.hadoop.hive.ql.plan;
 
-import java.io.ByteArrayOutputStream;
 import java.util.ArrayList;
 import java.util.List;
 
 import org.apache.hadoop.hive.ql.exec.Operator;
-import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.mapred.JobConf;
 
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDesc.java
index da03755..aaf9ff9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDesc.java
@@ -52,7 +52,7 @@
    */
   boolean isMapSide = false;
 
-  HiveConf cfg;
+  transient HiveConf cfg;
 
   static{
     PTFUtils.makeTransient(PTFDesc.class, "llInfo");
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java
index 7c5abf4..3aa6673 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java
@@ -47,7 +47,7 @@
   private java.util.Properties properties;
   private String serdeClassName;
 
-  private transient String baseFileName;
+  private String baseFileName;
 
   public void setBaseFileName(String baseFileName) {
     this.baseFileName = baseFileName;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFnGrams.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFnGrams.java
index 4f28628..4a7caab 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFnGrams.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFnGrams.java
@@ -160,15 +160,15 @@ public GenericUDAFEvaluator getEvaluator(TypeInfo[] parameters) throws SemanticE
    */
   public static class GenericUDAFnGramEvaluator extends GenericUDAFEvaluator {
     // For PARTIAL1 and COMPLETE: ObjectInspectors for original data
-    private StandardListObjectInspector outerInputOI;
-    private StandardListObjectInspector innerInputOI;
-    private PrimitiveObjectInspector inputOI;
-    private PrimitiveObjectInspector nOI;
-    private PrimitiveObjectInspector kOI;
-    private PrimitiveObjectInspector pOI;
+    private transient StandardListObjectInspector outerInputOI;
+    private transient StandardListObjectInspector innerInputOI;
+    private transient PrimitiveObjectInspector inputOI;
+    private transient PrimitiveObjectInspector nOI;
+    private transient PrimitiveObjectInspector kOI;
+    private transient PrimitiveObjectInspector pOI;
 
     // For PARTIAL2 and FINAL: ObjectInspectors for partial aggregations
-    private StandardListObjectInspector loi;
+    private transient StandardListObjectInspector loi;
 
     @Override
     public ObjectInspector init(Mode m, ObjectInspector[] parameters) throws HiveException {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFArray.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFArray.java
index 4176d3f..c429367 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFArray.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFArray.java
@@ -38,8 +38,8 @@
 @Description(name = "array",
     value = "_FUNC_(n0, n1...) - Creates an array with the given elements ")
 public class GenericUDFArray extends GenericUDF {
-  private Converter[] converters;
-  private ArrayList<Object> ret = new ArrayList<Object>();
+  private transient Converter[] converters;
+  private transient ArrayList<Object> ret = new ArrayList<Object>();
 
   @Override
   public ObjectInspector initialize(ObjectInspector[] arguments) throws UDFArgumentException {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBridge.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBridge.java
index a9feba4..c3c8ddc 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBridge.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBridge.java
@@ -22,6 +22,7 @@
 import java.lang.reflect.Method;
 import java.util.ArrayList;
 
+import org.apache.hadoop.hive.common.JavaUtils;
 import org.apache.hadoop.hive.ql.exec.FunctionRegistry;
 import org.apache.hadoop.hive.ql.exec.UDF;
 import org.apache.hadoop.hive.ql.exec.UDFArgumentException;
@@ -32,7 +33,6 @@
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory.ObjectInspectorOptions;
 import org.apache.hadoop.hive.serde2.typeinfo.TypeInfo;
 import org.apache.hadoop.hive.serde2.typeinfo.TypeInfoUtils;
-import org.apache.hadoop.util.ReflectionUtils;
 
 /**
  * GenericUDFBridge encapsulates UDF to provide the same interface as
@@ -55,29 +55,23 @@
   boolean isOperator;
 
   /**
-   * The underlying UDF class.
-   */
-  Class<? extends UDF> udfClass;
-
-  /**
    * The underlying UDF class Name.
    */
   String udfClassName;
 
   /**
-   * Greate a new GenericUDFBridge object.
+   * Create a new GenericUDFBridge object.
    *
    * @param udfName
    *          The name of the corresponding udf.
    * @param isOperator
-   * @param udfClass
+   * @param udfClassName java class name of UDF
    */
   public GenericUDFBridge(String udfName, boolean isOperator,
-      Class<? extends UDF> udfClass) {
+      String udfClassName) {
     this.udfName = udfName;
     this.isOperator = isOperator;
-    this.udfClass = udfClass;
-    this.udfClassName = udfClass != null ? udfClass.getName() : null;
+    this.udfClassName = udfClassName;
   }
 
   // For Java serialization only
@@ -108,12 +102,12 @@ public void setOperator(boolean isOperator) {
     this.isOperator = isOperator;
   }
 
-  public void setUdfClass(Class<? extends UDF> udfClass) {
-    this.udfClass = udfClass;
-  }
-
   public Class<? extends UDF> getUdfClass() {
-    return udfClass;
+    try {
+      return (Class<? extends UDF>) Class.forName(udfClassName, true, JavaUtils.getClassLoader());
+    } catch (ClassNotFoundException e) {
+      throw new RuntimeException(e);
+    }
   }
 
   /**
@@ -137,12 +131,13 @@ public void setUdfClass(Class<? extends UDF> udfClass) {
   @Override
   public ObjectInspector initialize(ObjectInspector[] arguments) throws UDFArgumentException {
 
-    if (udfClass == null) {
+    try {
+      udf = (UDF) Class.forName(udfClassName, true, JavaUtils.getClassLoader()).newInstance();
+    } catch (Exception e) {
       throw new UDFArgumentException(
           "The UDF implementation class '" + udfClassName
               + "' is not present in the class path");
     }
-    udf = (UDF) ReflectionUtils.newInstance(udfClass, null);
 
     // Resolve for the method based on argument types
     ArrayList<TypeInfo> argumentTypeInfos = new ArrayList<TypeInfo>(
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFormatNumber.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFormatNumber.java
index f23193e..a9a0176 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFormatNumber.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFormatNumber.java
@@ -54,10 +54,10 @@
     + "  '12,332.1235'")
 public class GenericUDFFormatNumber extends GenericUDF {
   private transient ObjectInspector[] argumentOIs;
-  private final Text resultText = new Text();
-  private final StringBuilder pattern = new StringBuilder("");
-  private final DecimalFormat numberFormat = new DecimalFormat("");
-  private int lastDValue = -1;
+  private transient final Text resultText = new Text();
+  private transient final StringBuilder pattern = new StringBuilder("");
+  private transient final DecimalFormat numberFormat = new DecimalFormat("");
+  private transient int lastDValue = -1;
 
   @Override
   public ObjectInspector initialize(ObjectInspector[] arguments) throws UDFArgumentException {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFIndex.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFIndex.java
index 0659dfa..5911f2c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFIndex.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFIndex.java
@@ -36,11 +36,11 @@
  */
 @Description(name = "index", value = "_FUNC_(a, n) - Returns the n-th element of a ")
 public class GenericUDFIndex extends GenericUDF {
-  private MapObjectInspector mapOI;
+  private transient MapObjectInspector mapOI;
   private boolean mapKeyPreferWritable;
-  private ListObjectInspector listOI;
-  private PrimitiveObjectInspector indexOI;
-  private ObjectInspector returnOI;
+  private transient ListObjectInspector listOI;
+  private transient PrimitiveObjectInspector indexOI;
+  private transient ObjectInspector returnOI;
 
   @Override
   public ObjectInspector initialize(ObjectInspector[] arguments) throws UDFArgumentException {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFNamedStruct.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFNamedStruct.java
index 2c18d93..7b18d82 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFNamedStruct.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFNamedStruct.java
@@ -35,7 +35,7 @@
     value = "_FUNC_(name1, val1, name2, val2, ...) - Creates a struct with the given " +
             "field names and values")
 public class GenericUDFNamedStruct extends GenericUDF {
-  Object[] ret;
+  private transient Object[] ret;
 
   @Override
   public ObjectInspector initialize(ObjectInspector[] arguments)
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFStruct.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFStruct.java
index 258c0bf..7c8dfcf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFStruct.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFStruct.java
@@ -31,7 +31,7 @@
 @Description(name = "struct",
     value = "_FUNC_(col1, col2, col3, ...) - Creates a struct with the given field values")
 public class GenericUDFStruct extends GenericUDF {
-  Object[] ret;
+  private transient Object[] ret;
 
   @Override
   public ObjectInspector initialize(ObjectInspector[] arguments)
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFToUnixTimeStamp.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFToUnixTimeStamp.java
index b0a755e..c1b2607 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFToUnixTimeStamp.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFToUnixTimeStamp.java
@@ -47,7 +47,7 @@
   private transient TimestampObjectInspector inputTimestampOI;
   private transient StringObjectInspector patternOI;
 
-  private String lasPattern = "yyyy-MM-dd HH:mm:ss";
+  private transient String lasPattern = "yyyy-MM-dd HH:mm:ss";
   private transient final SimpleDateFormat formatter = new SimpleDateFormat(lasPattern);
 
   @Override
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFExplode.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFExplode.java
index de2dfb1..9aec825 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFExplode.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFExplode.java
@@ -77,8 +77,8 @@ public StructObjectInspector initialize(ObjectInspector[] args) throws UDFArgume
         fieldOIs);
   }
 
-  private final Object[] forwardListObj = new Object[1];
-  private final Object[] forwardMapObj = new Object[2];
+  private transient final Object[] forwardListObj = new Object[1];
+  private transient final Object[] forwardMapObj = new Object[2];
 
   @Override
   public void process(Object[] o) throws HiveException {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFJSONTuple.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFJSONTuple.java
index 490198a..0336ecd 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFJSONTuple.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFJSONTuple.java
@@ -63,9 +63,10 @@
 
   int numCols;    // number of output columns
   String[] paths; // array of path expressions, each of which corresponds to a column
-  Text[] retCols; // array of returned column values
-  Text[] cols;    // object pool of non-null Text, avoid creating objects all the time
-  Object[] nullCols; // array of null column values
+  private transient Text[] retCols; // array of returned column values
+  //object pool of non-null Text, avoid creating objects all the time
+  private transient Text[] cols;
+  private transient Object[] nullCols; // array of null column values
   private transient ObjectInspector[] inputOIs; // input ObjectInspectors
   boolean pathParsed = false;
   boolean seenErrors = false;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFParseUrlTuple.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFParseUrlTuple.java
index 96ec55f..dff9ba6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFParseUrlTuple.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFParseUrlTuple.java
@@ -18,11 +18,11 @@
 
 package org.apache.hadoop.hive.ql.udf.generic;
 
-import java.net.URL;
 import java.net.MalformedURLException;
+import java.net.URL;
 import java.util.ArrayList;
-import java.util.regex.Pattern;
 import java.util.regex.Matcher;
+import java.util.regex.Pattern;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -65,13 +65,13 @@
   PARTNAME[] partnames; // mapping from pathnames to enum PARTNAME
   Text[] retCols; // array of returned column values
   Text[] cols;    // object pool of non-null Text, avoid creating objects all the time
-  Object[] nullCols; // array of null column values
-  ObjectInspector[] inputOIs; // input ObjectInspectors
+  private transient Object[] nullCols; // array of null column values
+  private transient ObjectInspector[] inputOIs; // input ObjectInspectors
   boolean pathParsed = false;
   boolean seenErrors = false;
-  URL url = null;
-  Pattern p = null;
-  String lastKey = null;
+  private transient URL url = null;
+  private transient Pattern p = null;
+  private transient String lastKey = null;
 
   @Override
   public void close() throws HiveException {
@@ -122,7 +122,7 @@ public StructObjectInspector initialize(ObjectInspector[] args)
       // all returned type will be Text
       fieldOIs.add(PrimitiveObjectInspectorFactory.writableStringObjectInspector);
     }
-    
+
     return ObjectInspectorFactory.getStandardStructObjectInspector(fieldNames, fieldOIs);
   }
 
@@ -137,7 +137,7 @@ public void process(Object[] o) throws HiveException {
     if (!pathParsed) {
         for (int i = 0;i < numCols; ++i) {
           paths[i] = ((StringObjectInspector) inputOIs[i+1]).getPrimitiveJavaObject(o[i+1]);
-          
+
           if (paths[i] == null) {
             partnames[i] = PARTNAME.NULLNAME;
           } else if (paths[i].equals("HOST")) {
@@ -158,11 +158,11 @@ public void process(Object[] o) throws HiveException {
             partnames[i] = PARTNAME.USERINFO;
           } else if (paths[i].startsWith("QUERY:")) {
             partnames[i] = PARTNAME.QUERY_WITH_KEY;
-            paths[i] = paths[i].substring(6); // update paths[i], e.g., from "QUERY:id" to "id" 
+            paths[i] = paths[i].substring(6); // update paths[i], e.g., from "QUERY:id" to "id"
           } else {
             partnames[i] = PARTNAME.NULLNAME;
-          } 
-      }    
+          }
+      }
       pathParsed = true;
     }
 
@@ -171,9 +171,9 @@ public void process(Object[] o) throws HiveException {
       forward(nullCols);
       return;
     }
-    
+
     try {
-      String ret = null; 
+      String ret = null;
       url = new URL(urlStr);
       for (int i = 0; i < numCols; ++i) {
         ret = evaluate(url, i);
@@ -188,7 +188,7 @@ public void process(Object[] o) throws HiveException {
       }
 
       forward(retCols);
-      return;    
+      return;
     } catch (MalformedURLException e) {
       // parsing error, invalid url string
       if (!seenErrors) {
@@ -204,10 +204,11 @@ public void process(Object[] o) throws HiveException {
   public String toString() {
     return "parse_url_tuple";
   }
-  
+
   private String evaluate(URL url, int index) {
-    if (url == null || index < 0 || index >= partnames.length)
+    if (url == null || index < 0 || index >= partnames.length) {
       return null;
+    }
 
     switch (partnames[index]) {
       case HOST          : return url.getHost();
@@ -239,5 +240,5 @@ private String evaluateQuery(String query, String key) {
       return m.group(2);
     }
     return null;
-  } 
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFStack.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFStack.java
index 2c423fa..1a744e0 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFStack.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFStack.java
@@ -48,7 +48,7 @@ public void close() throws HiveException {
   }
 
   private transient List<ObjectInspector> argOIs = new ArrayList<ObjectInspector>();
-  Object[] forwardObj = null;
+  private transient Object[] forwardObj = null;
   private transient ArrayList<ReturnObjectInspectorResolver> returnOIResolvers =
       new ArrayList<ReturnObjectInspectorResolver>();
   IntWritable numRows = null;
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
index 79a29e1..def604d 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
@@ -198,7 +198,7 @@ public String getOutputDirectory() {
   public String getLogDirectory() {
     return logDir;
   }
-  
+
   private String getHadoopMainVersion(String input) {
     if (input == null) {
       return null;
@@ -884,17 +884,21 @@ public int checkParseResults(String tname, ASTNode tree) throws Exception {
 
   public int checkPlan(String tname, List<Task<? extends Serializable>> tasks) throws Exception {
 
-    if (tasks != null) {
-      File planDir = new File(outDir, "plan");
-      String planFile = outPath(planDir.toString(), tname + ".xml");
+    if (tasks == null) {
+      throw new Exception("Plan is null");
+    }
+    File planDir = new File(outDir, "plan");
+    String planFile = outPath(planDir.toString(), tname + ".xml");
 
-      File outf = null;
-      outf = new File(logDir);
-      outf = new File(outf, tname.concat(".xml"));
+    File outf = null;
+    outf = new File(logDir);
+    outf = new File(outf, tname.concat(".xml"));
 
-      FileOutputStream ofs = new FileOutputStream(outf);
+    FileOutputStream ofs = new FileOutputStream(outf);
+    try {
+      conf.set(HiveConf.ConfVars.PLAN_SERIALIZATION.varname, "javaXML");
       for (Task<? extends Serializable> plan : tasks) {
-        Utilities.serializeObject(plan, ofs);
+        Utilities.serializePlan(plan, ofs, conf);
       }
       
       fixXml4JDK7(outf.getPath());
@@ -905,12 +909,10 @@ public int checkPlan(String tname, List<Task<? extends Serializable>> tasks) thr
       if (exitVal != 0 && overWrite) {
         exitVal = overwriteResults(outf.getPath(), planFile);
       }
-
       return exitVal;
-    } else {
-      throw new Exception("Plan is null");
+    } finally {
+      conf.set(HiveConf.ConfVars.PLAN_SERIALIZATION.varname, "kryo");
     }
-
   }
 
   /**
@@ -951,10 +953,10 @@ public String outPath(String outDir, String testName) {
   /**
    * Fix the XML generated by JDK7 which is slightly different from what's generated by JDK6,
    * causing 40+ test failures. There are mainly two problems:
-   * 
+   *
    * 1. object element's properties, id and class, are in reverse order, i.e.
    *    <object class="org.apache.hadoop.hive.ql.exec.MapRedTask" id="MapRedTask0">
-   *    which needs to be fixed to 
+   *    which needs to be fixed to
    *    <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask">
    * 2. JDK introduces Enum as class, i.e.
    *    <object id="GenericUDAFEvaluator$Mode0" class="java.lang.Enum">
@@ -962,11 +964,11 @@ public String outPath(String outDir, String testName) {
    *    which needs to be fixed to
    *    <object id="GenericUDAFEvaluator$Mode0" class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode"
    *     method="valueOf">
-   *    
+   *
    * Though not elegant, this allows these test cases to pass until we have a better serialization mechanism.
-   * 
+   *
    * Did I mention this is test code?
-   *    
+   *
    * @param fname the name of the file to fix
    * @throws Exception in case of IO error
    */
@@ -975,7 +977,7 @@ private static void fixXml4JDK7(String fname) throws Exception {
     if (!version.startsWith("1.7")) {
       return;
     }
-    
+
     BufferedReader in = new BufferedReader(new FileReader(fname));
     BufferedWriter out = new BufferedWriter(new FileWriter(fname + ".orig"));
     String line = null;
@@ -988,7 +990,7 @@ private static void fixXml4JDK7(String fname) throws Exception {
 
     in = new BufferedReader(new FileReader(fname + ".orig"));
     out = new BufferedWriter(new FileWriter(fname));
-    
+
     while (null != (line = in.readLine())) {
       if (line.indexOf("<object ") == -1 || line.indexOf("class=") == -1) {
         out.write(line);
@@ -998,8 +1000,9 @@ private static void fixXml4JDK7(String fname) throws Exception {
         sb.append( prefix );
         String postfix = line.substring(line.lastIndexOf('"') + 1);
         String id = getPropertyValue(line, "id");
-        if (id != null)
+        if (id != null) {
           sb.append(" id=" + id);
+        }
         String cls = getPropertyValue(line, "class");
         assert(cls != null);
         if (cls.equals("\"java.lang.Enum\"")) {
@@ -1012,27 +1015,28 @@ private static void fixXml4JDK7(String fname) throws Exception {
 
         sb.append(postfix);
         out.write(sb.toString());
-      } 
-      
+      }
+
       out.write('\n');
     }
 
     in.close();
     out.close();
   }
-  
+
   /**
    * Get the value of a property in line. The returned value has original quotes
    */
   private static String getPropertyValue(String line, String name) {
     int start = line.indexOf( name + "=" );
-    if (start == -1)
+    if (start == -1) {
       return null;
+    }
     start += name.length() + 1;
     int end = line.indexOf("\"", start + 1);
     return line.substring( start, end + 1 );
   }
-  
+
   /**
    * Get the value of the element in input. (Note: the returned value has no quotes.)
    */
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/exec/TestPlan.java b/ql/src/test/org/apache/hadoop/hive/ql/exec/TestPlan.java
index e0ffa6a..f1e8555 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/exec/TestPlan.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/exec/TestPlan.java
@@ -79,14 +79,15 @@ public void testPlan() throws Exception {
       mrwork.getMapWork().setPathToPartitionInfo(pt);
       mrwork.getMapWork().setAliasToWork(ao);
 
+      JobConf job = new JobConf(TestPlan.class);
       // serialize the configuration once ..
       ByteArrayOutputStream baos = new ByteArrayOutputStream();
-      Utilities.serializeObject(mrwork, baos);
+      Utilities.serializePlan(mrwork, baos, job);
       baos.close();
       String v1 = baos.toString();
 
       // store into configuration
-      JobConf job = new JobConf(TestPlan.class);
+
       job.set("fs.default.name", "file:///");
       Utilities.setMapRedWork(job, mrwork, System.getProperty("java.io.tmpdir") + File.separator +
         System.getProperty("user.name") + File.separator + "hive");
@@ -99,7 +100,7 @@ public void testPlan() throws Exception {
 
       // serialize again
       baos.reset();
-      Utilities.serializeObject(mrwork2, baos);
+      Utilities.serializePlan(mrwork2, baos, job);
       baos.close();
 
       // verify that the two are equal
diff --git a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
index ac9ebd1..54863b1 100644
--- a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
+++ b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -960,6 +966,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -970,6 +979,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1090,6 +1102,9 @@
                   <void property="type"> 
                    <object idref="ListTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>array&lt;int&gt;</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1103,6 +1118,9 @@
                   <void property="type"> 
                    <object idref="ListTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1177,6 +1195,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>int</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1190,6 +1211,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1210,6 +1234,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>array&lt;string&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1233,6 +1260,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>map&lt;string,string&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1253,6 +1283,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1269,6 +1302,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/cast1.q.xml b/ql/src/test/results/compiler/plan/cast1.q.xml
index 883c69b..c89e0e8 100644
--- a/ql/src/test/results/compiler/plan/cast1.q.xml
+++ b/ql/src/test/results/compiler/plan/cast1.q.xml
@@ -277,6 +277,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -294,6 +297,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>double</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -307,6 +313,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>double</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -320,6 +329,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>double</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -333,6 +345,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -350,6 +365,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -363,6 +381,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -394,9 +415,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFToInteger</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFToInteger</string> 
                       </void> 
@@ -429,9 +447,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFToBoolean</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFToBoolean</string> 
                       </void> 
@@ -478,9 +493,6 @@
                         </void> 
                         <void property="genericUDF"> 
                          <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFToInteger</class> 
-                          </void> 
                           <void property="udfClassName"> 
                            <string>org.apache.hadoop.hive.ql.udf.UDFToInteger</string> 
                           </void> 
@@ -501,9 +513,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                       </void> 
@@ -549,9 +558,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                       </void> 
@@ -597,9 +603,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                       </void> 
@@ -645,9 +648,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                       </void> 
@@ -693,9 +693,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                       </void> 
@@ -806,6 +803,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -819,6 +819,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -832,6 +835,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -845,6 +851,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -858,6 +867,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -871,6 +883,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -884,6 +899,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -980,6 +998,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo3"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1051,6 +1072,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1071,6 +1095,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1087,6 +1114,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby1.q.xml b/ql/src/test/results/compiler/plan/groupby1.q.xml
index 1663209..2e35d98 100755
--- a/ql/src/test/results/compiler/plan/groupby1.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby1.q.xml
@@ -512,6 +512,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -522,6 +525,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>double</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -604,9 +610,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -706,6 +709,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -719,6 +725,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -887,6 +896,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -900,6 +912,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -983,6 +998,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -999,6 +1017,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1295,6 +1316,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1308,6 +1332,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1412,6 +1439,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1422,6 +1452,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1559,6 +1592,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1572,6 +1608,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>double</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby2.q.xml b/ql/src/test/results/compiler/plan/groupby2.q.xml
index 607cd2b..fc3a37f 100755
--- a/ql/src/test/results/compiler/plan/groupby2.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby2.q.xml
@@ -415,6 +415,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -425,6 +428,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -435,6 +441,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo2"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>bigint</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -445,6 +454,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>double</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -493,9 +505,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                       </void> 
@@ -551,9 +560,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                       </void> 
@@ -622,9 +628,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -686,9 +689,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -800,6 +800,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -813,6 +816,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -826,6 +832,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -839,6 +848,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1003,6 +1015,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1016,6 +1031,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1099,6 +1117,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1115,6 +1136,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1427,6 +1451,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1440,6 +1467,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1453,6 +1483,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1607,6 +1640,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1620,6 +1656,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1633,6 +1672,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1808,6 +1850,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1821,6 +1866,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1834,6 +1882,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>double</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby3.q.xml b/ql/src/test/results/compiler/plan/groupby3.q.xml
index ae24c8a..f3a943c 100644
--- a/ql/src/test/results/compiler/plan/groupby3.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby3.q.xml
@@ -469,6 +469,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -479,6 +482,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo2"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>double</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -489,6 +495,9 @@
                           <void property="type"> 
                            <object idref="StructTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>struct&lt;count:bigint,sum:double&gt;</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -499,6 +508,9 @@
                           <void property="type"> 
                            <object idref="StructTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>struct&lt;count:bigint,sum:double&gt;</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -509,6 +521,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -519,6 +534,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -567,9 +585,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                       </void> 
@@ -635,9 +650,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -699,9 +711,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -766,9 +775,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -830,9 +836,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -894,9 +897,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -1008,6 +1008,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1021,6 +1024,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1034,6 +1040,9 @@
                       <void property="type"> 
                        <object idref="StructTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>struct&lt;count:bigint,sum:double&gt;</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1047,6 +1056,9 @@
                       <void property="type"> 
                        <object idref="StructTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>struct&lt;count:bigint,sum:double&gt;</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1060,6 +1072,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1073,6 +1088,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1221,6 +1239,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1289,6 +1310,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1308,6 +1332,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1324,6 +1351,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1636,6 +1666,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1649,6 +1682,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1662,6 +1698,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1675,6 +1714,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1688,6 +1730,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1855,6 +1900,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1868,6 +1916,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1881,6 +1932,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1894,6 +1948,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1907,6 +1964,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2153,6 +2213,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>double</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2166,6 +2229,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>double</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2179,6 +2245,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>double</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2192,6 +2261,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2205,6 +2277,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby4.q.xml b/ql/src/test/results/compiler/plan/groupby4.q.xml
index 1232c63..b575d7f 100644
--- a/ql/src/test/results/compiler/plan/groupby4.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby4.q.xml
@@ -333,6 +333,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -391,9 +394,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                       </void> 
@@ -491,6 +491,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -643,6 +646,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -714,6 +720,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -730,6 +739,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -746,6 +758,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1058,6 +1073,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1145,6 +1163,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1249,6 +1270,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby5.q.xml b/ql/src/test/results/compiler/plan/groupby5.q.xml
index 78f772e..2ba2ebe 100644
--- a/ql/src/test/results/compiler/plan/groupby5.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby5.q.xml
@@ -359,6 +359,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -369,6 +372,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>double</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -451,9 +457,6 @@
                           </void> 
                           <void property="genericUDF"> 
                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                            </void> 
                             <void property="udfClassName"> 
                              <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                             </void> 
@@ -553,6 +556,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -566,6 +572,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -734,6 +743,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -747,6 +759,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -830,6 +845,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -846,6 +864,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1158,6 +1179,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1171,6 +1195,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1278,6 +1305,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1291,6 +1321,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1428,6 +1461,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1441,6 +1477,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>double</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby6.q.xml b/ql/src/test/results/compiler/plan/groupby6.q.xml
index 2167f1d..a262c93 100644
--- a/ql/src/test/results/compiler/plan/groupby6.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby6.q.xml
@@ -333,6 +333,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -391,9 +394,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFSubstr</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                       </void> 
@@ -491,6 +491,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -643,6 +646,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -711,6 +717,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -730,6 +739,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -746,6 +758,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1058,6 +1073,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1145,6 +1163,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1249,6 +1270,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input1.q.xml b/ql/src/test/results/compiler/plan/input1.q.xml
index fe1f2f8..4d0c0e8 100755
--- a/ql/src/test/results/compiler/plan/input1.q.xml
+++ b/ql/src/test/results/compiler/plan/input1.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -855,6 +861,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -868,6 +877,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -968,6 +980,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -981,6 +996,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1068,6 +1086,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1084,6 +1105,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input2.q.xml b/ql/src/test/results/compiler/plan/input2.q.xml
index 94f66ff..619b6e5 100755
--- a/ql/src/test/results/compiler/plan/input2.q.xml
+++ b/ql/src/test/results/compiler/plan/input2.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -708,6 +714,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -721,6 +730,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -1219,6 +1231,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -1232,6 +1247,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -1885,6 +1903,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1898,6 +1919,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1998,6 +2022,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2011,6 +2038,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2193,6 +2223,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2206,6 +2239,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2524,6 +2560,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2534,6 +2573,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2703,6 +2745,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2719,6 +2764,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input20.q.xml b/ql/src/test/results/compiler/plan/input20.q.xml
index 270c710..f31a549 100644
--- a/ql/src/test/results/compiler/plan/input20.q.xml
+++ b/ql/src/test/results/compiler/plan/input20.q.xml
@@ -376,6 +376,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -389,6 +392,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -592,9 +598,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                   </void> 
@@ -647,9 +650,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                   </void> 
@@ -727,6 +727,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -737,6 +740,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -805,6 +811,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -818,6 +827,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -838,6 +850,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -854,6 +869,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1170,6 +1188,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1183,6 +1204,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1345,6 +1369,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1358,6 +1385,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1462,6 +1492,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1472,6 +1505,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1540,6 +1576,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1553,6 +1592,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input3.q.xml b/ql/src/test/results/compiler/plan/input3.q.xml
index 427c8cf..fb8b6f4 100755
--- a/ql/src/test/results/compiler/plan/input3.q.xml
+++ b/ql/src/test/results/compiler/plan/input3.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -708,6 +714,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -721,6 +730,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -1219,6 +1231,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -1232,6 +1247,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -1668,6 +1686,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -2252,6 +2273,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2265,6 +2289,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2365,6 +2392,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2378,6 +2408,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2560,6 +2593,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2573,6 +2609,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2891,6 +2930,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2901,6 +2943,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -3190,6 +3235,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -3362,6 +3410,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -3378,6 +3429,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input4.q.xml b/ql/src/test/results/compiler/plan/input4.q.xml
index 6da9697..2879f0d 100755
--- a/ql/src/test/results/compiler/plan/input4.q.xml
+++ b/ql/src/test/results/compiler/plan/input4.q.xml
@@ -533,6 +533,9 @@
                               <void property="type"> 
                                <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
+                              <void property="typeName"> 
+                               <string>string</string> 
+                              </void> 
                              </object> 
                             </void> 
                             <void method="add"> 
@@ -546,6 +549,9 @@
                               <void property="type"> 
                                <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
+                              <void property="typeName"> 
+                               <string>string</string> 
+                              </void> 
                              </object> 
                             </void> 
                            </object> 
@@ -874,6 +880,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -884,6 +893,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -958,6 +970,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -971,6 +986,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -991,6 +1009,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1007,6 +1028,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1303,6 +1327,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1316,6 +1343,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1423,6 +1453,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1436,6 +1469,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1504,6 +1540,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1517,6 +1556,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input5.q.xml b/ql/src/test/results/compiler/plan/input5.q.xml
index cf5434d..8802146 100644
--- a/ql/src/test/results/compiler/plan/input5.q.xml
+++ b/ql/src/test/results/compiler/plan/input5.q.xml
@@ -537,6 +537,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -550,6 +553,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -841,6 +847,9 @@
                   <void property="type"> 
                    <object idref="ListTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>array&lt;int&gt;</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -851,6 +860,9 @@
                   <void property="type"> 
                    <object idref="ListTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -925,6 +937,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>int</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -938,6 +953,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -951,6 +969,9 @@
               <void property="type"> 
                <object idref="ListTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>array&lt;int&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -968,6 +989,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>array&lt;string&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -981,6 +1005,9 @@
               <void property="type"> 
                <object idref="ListTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1001,6 +1028,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>map&lt;string,string&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1021,6 +1051,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1037,6 +1070,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1341,6 +1377,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1354,6 +1393,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1461,6 +1503,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1474,6 +1519,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1542,6 +1590,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1555,6 +1606,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input6.q.xml b/ql/src/test/results/compiler/plan/input6.q.xml
index bacc72c..6a5dbdf 100644
--- a/ql/src/test/results/compiler/plan/input6.q.xml
+++ b/ql/src/test/results/compiler/plan/input6.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -855,6 +861,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -868,6 +877,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -954,6 +966,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -967,6 +982,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1054,6 +1072,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1070,6 +1091,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input7.q.xml b/ql/src/test/results/compiler/plan/input7.q.xml
index 0e11f15..ac1ca96 100644
--- a/ql/src/test/results/compiler/plan/input7.q.xml
+++ b/ql/src/test/results/compiler/plan/input7.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -846,6 +852,9 @@
                     </void> 
                    </object> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>void</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -859,6 +868,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -927,6 +939,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -940,6 +955,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -960,6 +978,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -976,6 +997,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input8.q.xml b/ql/src/test/results/compiler/plan/input8.q.xml
index f1bc910..2b7a3c4 100644
--- a/ql/src/test/results/compiler/plan/input8.q.xml
+++ b/ql/src/test/results/compiler/plan/input8.q.xml
@@ -273,6 +273,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -290,6 +293,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -307,6 +313,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>tinyint</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -337,9 +346,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                   </void> 
@@ -385,9 +391,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPMinus</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPMinus</string> 
                   </void> 
@@ -426,9 +429,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                   </void> 
@@ -515,6 +515,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -528,6 +531,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -541,6 +547,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>tinyint</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -609,6 +618,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -622,6 +634,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -642,6 +657,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -658,6 +676,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input9.q.xml b/ql/src/test/results/compiler/plan/input9.q.xml
index dcbde06..a461aab 100644
--- a/ql/src/test/results/compiler/plan/input9.q.xml
+++ b/ql/src/test/results/compiler/plan/input9.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -850,6 +856,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>void</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -863,6 +872,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -950,6 +962,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1021,6 +1036,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1041,6 +1059,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1057,6 +1078,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input_part1.q.xml b/ql/src/test/results/compiler/plan/input_part1.q.xml
index 67cd1a7..2be3c16 100644
--- a/ql/src/test/results/compiler/plan/input_part1.q.xml
+++ b/ql/src/test/results/compiler/plan/input_part1.q.xml
@@ -314,6 +314,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -327,6 +330,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -340,6 +346,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -353,6 +362,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -509,6 +521,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -525,6 +540,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -541,6 +559,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -557,6 +578,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -657,6 +681,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -670,6 +697,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -683,6 +713,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -696,6 +729,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -789,6 +825,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -805,6 +844,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
index 6776526..9296ec9 100644
--- a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -851,6 +857,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -864,6 +873,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -938,6 +950,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -951,6 +966,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -971,6 +989,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -987,6 +1008,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath.q.xml b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
index cb5db5d..489b23a 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
@@ -281,6 +281,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -298,6 +301,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -311,6 +317,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -565,6 +574,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -578,6 +590,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -591,6 +606,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -671,6 +689,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>int</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -684,6 +705,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -697,6 +721,9 @@
               <void property="type"> 
                <object idref="ListTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>array&lt;int&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -714,6 +741,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>array&lt;string&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -727,6 +757,9 @@
               <void property="type"> 
                <object idref="ListTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -740,6 +773,9 @@
               <void property="type"> 
                <object idref="MapTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>map&lt;string,string&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -760,6 +796,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -776,6 +815,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
index 2904554..2519630 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
@@ -285,6 +285,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -298,6 +301,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -311,6 +317,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -526,6 +535,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -539,6 +551,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -552,6 +567,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -693,6 +711,9 @@
                   <void property="type"> 
                    <object idref="ListTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>array&lt;int&gt;</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -706,6 +727,9 @@
                   <void property="type"> 
                    <object idref="ListTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -719,6 +743,9 @@
                   <void property="type"> 
                    <object idref="MapTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>map&lt;string,string&gt;</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -799,6 +826,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>int</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -812,6 +842,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -832,6 +865,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>array&lt;string&gt;</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -858,6 +894,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -874,6 +913,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/join1.q.xml b/ql/src/test/results/compiler/plan/join1.q.xml
index fe793a5..cca7398 100644
--- a/ql/src/test/results/compiler/plan/join1.q.xml
+++ b/ql/src/test/results/compiler/plan/join1.q.xml
@@ -664,6 +664,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -677,6 +680,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -751,6 +757,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -764,6 +773,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -784,6 +796,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -800,6 +815,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -989,6 +1007,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1057,6 +1078,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1070,6 +1094,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1086,6 +1113,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1102,6 +1132,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1404,6 +1437,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1417,6 +1453,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1524,6 +1563,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1537,6 +1579,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1755,6 +1800,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1768,6 +1816,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/join2.q.xml b/ql/src/test/results/compiler/plan/join2.q.xml
index ed0e89d..4e027ce 100644
--- a/ql/src/test/results/compiler/plan/join2.q.xml
+++ b/ql/src/test/results/compiler/plan/join2.q.xml
@@ -398,9 +398,6 @@
                         <void property="operator"> 
                          <boolean>true</boolean> 
                         </void> 
-                        <void property="udfClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                        </void> 
                         <void property="udfClassName"> 
                          <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                         </void> 
@@ -551,6 +548,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -595,6 +595,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -608,6 +611,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -669,9 +675,6 @@
                       </void> 
                       <void property="genericUDF"> 
                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                        <void property="udfClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                        </void> 
                         <void property="udfClassName"> 
                          <string>org.apache.hadoop.hive.ql.udf.UDFToDouble</string> 
                         </void> 
@@ -824,6 +827,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -898,6 +904,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -911,6 +920,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -931,6 +943,9 @@
                     </void> 
                    </object> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -947,6 +962,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1303,6 +1321,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1316,6 +1337,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1423,6 +1447,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1436,6 +1463,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1673,6 +1703,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1686,6 +1719,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2199,6 +2235,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2267,6 +2306,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2280,6 +2322,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2296,6 +2341,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2312,6 +2360,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -2501,6 +2552,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2569,6 +2623,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2582,6 +2639,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2598,6 +2658,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2614,6 +2677,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/join3.q.xml b/ql/src/test/results/compiler/plan/join3.q.xml
index 7b413a0..36fa4cf 100644
--- a/ql/src/test/results/compiler/plan/join3.q.xml
+++ b/ql/src/test/results/compiler/plan/join3.q.xml
@@ -790,6 +790,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -858,6 +861,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -871,6 +877,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -891,6 +900,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -907,6 +919,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1113,6 +1128,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1126,6 +1144,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1200,6 +1221,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1213,6 +1237,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1229,6 +1256,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1245,6 +1275,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1434,6 +1467,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1502,6 +1538,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1515,6 +1554,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1531,6 +1573,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1547,6 +1592,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1852,6 +1900,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1865,6 +1916,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1972,6 +2026,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1985,6 +2042,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2248,6 +2308,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2261,6 +2324,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/join4.q.xml b/ql/src/test/results/compiler/plan/join4.q.xml
index dce5acf..6815913 100644
--- a/ql/src/test/results/compiler/plan/join4.q.xml
+++ b/ql/src/test/results/compiler/plan/join4.q.xml
@@ -513,6 +513,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -526,6 +529,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -630,6 +636,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -640,6 +649,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -791,6 +803,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -804,6 +819,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -891,6 +909,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -907,6 +928,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1118,6 +1142,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1131,6 +1158,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1235,6 +1265,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1245,6 +1278,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1388,6 +1424,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1401,6 +1440,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1484,6 +1526,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1500,6 +1545,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1818,6 +1866,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1831,6 +1882,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1844,6 +1898,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1857,6 +1914,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2007,6 +2067,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2023,6 +2086,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2039,6 +2105,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2055,6 +2124,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2305,6 +2377,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2318,6 +2393,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2331,6 +2409,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2344,6 +2425,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/join5.q.xml b/ql/src/test/results/compiler/plan/join5.q.xml
index 03e38ff..2dd3e9f 100644
--- a/ql/src/test/results/compiler/plan/join5.q.xml
+++ b/ql/src/test/results/compiler/plan/join5.q.xml
@@ -513,6 +513,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -526,6 +529,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -630,6 +636,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -640,6 +649,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -791,6 +803,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -804,6 +819,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -891,6 +909,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -907,6 +928,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1118,6 +1142,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1131,6 +1158,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1235,6 +1265,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1245,6 +1278,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1388,6 +1424,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1401,6 +1440,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1484,6 +1526,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1500,6 +1545,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1818,6 +1866,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1831,6 +1882,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1844,6 +1898,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1857,6 +1914,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2007,6 +2067,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2023,6 +2086,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2039,6 +2105,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2055,6 +2124,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2301,6 +2373,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2314,6 +2389,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2327,6 +2405,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2340,6 +2421,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/join6.q.xml b/ql/src/test/results/compiler/plan/join6.q.xml
index 40a667c..b560214 100644
--- a/ql/src/test/results/compiler/plan/join6.q.xml
+++ b/ql/src/test/results/compiler/plan/join6.q.xml
@@ -513,6 +513,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -526,6 +529,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -630,6 +636,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -640,6 +649,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -791,6 +803,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -804,6 +819,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -891,6 +909,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -907,6 +928,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1118,6 +1142,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1131,6 +1158,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1235,6 +1265,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1245,6 +1278,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1388,6 +1424,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1401,6 +1440,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1484,6 +1526,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1500,6 +1545,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1818,6 +1866,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1831,6 +1882,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1844,6 +1898,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1857,6 +1914,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2007,6 +2067,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2023,6 +2086,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2039,6 +2105,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2055,6 +2124,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2308,6 +2380,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2321,6 +2396,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2334,6 +2412,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2347,6 +2428,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/join7.q.xml b/ql/src/test/results/compiler/plan/join7.q.xml
index 7b04934..0418ddd 100644
--- a/ql/src/test/results/compiler/plan/join7.q.xml
+++ b/ql/src/test/results/compiler/plan/join7.q.xml
@@ -661,6 +661,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -674,6 +677,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -778,6 +784,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -788,6 +797,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -939,6 +951,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -952,6 +967,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1039,6 +1057,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1055,6 +1076,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1266,6 +1290,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1279,6 +1306,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1383,6 +1413,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1393,6 +1426,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1536,6 +1572,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1549,6 +1588,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1632,6 +1674,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1648,6 +1693,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1859,6 +1907,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1872,6 +1923,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1976,6 +2030,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1986,6 +2043,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2129,6 +2189,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2142,6 +2205,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -2225,6 +2291,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -2241,6 +2310,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -2562,6 +2634,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2575,6 +2650,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2588,6 +2666,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2601,6 +2682,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2614,6 +2698,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2627,6 +2714,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2817,6 +2907,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2833,6 +2926,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2849,6 +2945,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2865,6 +2964,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2881,6 +2983,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2897,6 +3002,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -3234,6 +3342,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -3247,6 +3358,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -3260,6 +3374,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -3273,6 +3390,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -3286,6 +3406,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -3299,6 +3422,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/join8.q.xml b/ql/src/test/results/compiler/plan/join8.q.xml
index 33f5307..7a76edc 100644
--- a/ql/src/test/results/compiler/plan/join8.q.xml
+++ b/ql/src/test/results/compiler/plan/join8.q.xml
@@ -513,6 +513,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -526,6 +529,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -630,6 +636,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -640,6 +649,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -832,6 +844,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -845,6 +860,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -932,6 +950,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -948,6 +969,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1159,6 +1183,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1172,6 +1199,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1276,6 +1306,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1286,6 +1319,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1470,6 +1506,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1483,6 +1522,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1566,6 +1608,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1582,6 +1627,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
@@ -1904,6 +1952,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1917,6 +1968,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1930,6 +1984,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1943,6 +2000,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -2093,6 +2153,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2109,6 +2172,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2125,6 +2191,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -2141,6 +2210,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -2213,6 +2285,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2226,6 +2301,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2239,6 +2317,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -2252,6 +2333,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
diff --git a/ql/src/test/results/compiler/plan/sample1.q.xml b/ql/src/test/results/compiler/plan/sample1.q.xml
index 57620b6..1431bf2 100644
--- a/ql/src/test/results/compiler/plan/sample1.q.xml
+++ b/ql/src/test/results/compiler/plan/sample1.q.xml
@@ -314,6 +314,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -327,6 +330,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -340,6 +346,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -353,6 +362,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -512,6 +524,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -528,6 +543,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -544,6 +562,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -560,6 +581,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -598,9 +622,6 @@
                                 </void> 
                                 <void property="genericUDF"> 
                                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                                  <void property="udfClass"> 
-                                   <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
-                                  </void> 
                                   <void property="udfClassName"> 
                                    <string>org.apache.hadoop.hive.ql.udf.UDFRand</string> 
                                   </void> 
@@ -649,9 +670,6 @@
                           <void property="operator"> 
                            <boolean>true</boolean> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                          </void> 
                           <void property="udfClassName"> 
                            <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
                           </void> 
@@ -682,9 +700,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                       </void> 
@@ -765,6 +780,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -778,6 +796,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -791,6 +812,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -804,6 +828,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -897,6 +924,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -913,6 +943,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/sample2.q.xml b/ql/src/test/results/compiler/plan/sample2.q.xml
index 0735b71..68a7e24 100644
--- a/ql/src/test/results/compiler/plan/sample2.q.xml
+++ b/ql/src/test/results/compiler/plan/sample2.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -870,6 +876,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -883,6 +892,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -954,9 +966,6 @@
                           <void property="operator"> 
                            <boolean>true</boolean> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                          </void> 
                           <void property="udfClassName"> 
                            <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
                           </void> 
@@ -987,9 +996,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                       </void> 
@@ -1073,6 +1079,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1086,6 +1095,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1173,6 +1185,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1189,6 +1204,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/sample3.q.xml b/ql/src/test/results/compiler/plan/sample3.q.xml
index 8c66298..ef80238 100644
--- a/ql/src/test/results/compiler/plan/sample3.q.xml
+++ b/ql/src/test/results/compiler/plan/sample3.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -870,6 +876,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -883,6 +892,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -967,9 +979,6 @@
                           <void property="operator"> 
                            <boolean>true</boolean> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                          </void> 
                           <void property="udfClassName"> 
                            <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
                           </void> 
@@ -1000,9 +1009,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                       </void> 
@@ -1083,6 +1089,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1096,6 +1105,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1183,6 +1195,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1199,6 +1214,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/sample4.q.xml b/ql/src/test/results/compiler/plan/sample4.q.xml
index 0735b71..68a7e24 100644
--- a/ql/src/test/results/compiler/plan/sample4.q.xml
+++ b/ql/src/test/results/compiler/plan/sample4.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -870,6 +876,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -883,6 +892,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -954,9 +966,6 @@
                           <void property="operator"> 
                            <boolean>true</boolean> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                          </void> 
                           <void property="udfClassName"> 
                            <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
                           </void> 
@@ -987,9 +996,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                       </void> 
@@ -1073,6 +1079,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1086,6 +1095,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1173,6 +1185,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1189,6 +1204,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/sample5.q.xml b/ql/src/test/results/compiler/plan/sample5.q.xml
index 95317c9..03a5ef0 100644
--- a/ql/src/test/results/compiler/plan/sample5.q.xml
+++ b/ql/src/test/results/compiler/plan/sample5.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -870,6 +876,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -883,6 +892,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -954,9 +966,6 @@
                           <void property="operator"> 
                            <boolean>true</boolean> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                          </void> 
                           <void property="udfClassName"> 
                            <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
                           </void> 
@@ -987,9 +996,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                       </void> 
@@ -1070,6 +1076,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1083,6 +1092,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1170,6 +1182,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1186,6 +1201,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/sample6.q.xml b/ql/src/test/results/compiler/plan/sample6.q.xml
index d925c0e..8c8782a 100644
--- a/ql/src/test/results/compiler/plan/sample6.q.xml
+++ b/ql/src/test/results/compiler/plan/sample6.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -870,6 +876,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -883,6 +892,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -954,9 +966,6 @@
                           <void property="operator"> 
                            <boolean>true</boolean> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                          </void> 
                           <void property="udfClassName"> 
                            <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
                           </void> 
@@ -987,9 +996,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                       </void> 
@@ -1073,6 +1079,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1086,6 +1095,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1173,6 +1185,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1189,6 +1204,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/sample7.q.xml b/ql/src/test/results/compiler/plan/sample7.q.xml
index 38b32ae..25e4414 100644
--- a/ql/src/test/results/compiler/plan/sample7.q.xml
+++ b/ql/src/test/results/compiler/plan/sample7.q.xml
@@ -201,6 +201,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -214,6 +217,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -870,6 +876,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -883,6 +892,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -955,9 +967,6 @@
                               <void property="operator"> 
                                <boolean>true</boolean> 
                               </void> 
-                              <void property="udfClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                              </void> 
                               <void property="udfClassName"> 
                                <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
                               </void> 
@@ -988,9 +997,6 @@
                           <void property="operator"> 
                            <boolean>true</boolean> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                          </void> 
                           <void property="udfClassName"> 
                            <string>org.apache.hadoop.hive.ql.udf.UDFOPMod</string> 
                           </void> 
@@ -1118,6 +1124,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1131,6 +1140,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1218,6 +1230,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1234,6 +1249,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/subq.q.xml b/ql/src/test/results/compiler/plan/subq.q.xml
index 503927a..23f79d5 100644
--- a/ql/src/test/results/compiler/plan/subq.q.xml
+++ b/ql/src/test/results/compiler/plan/subq.q.xml
@@ -134,6 +134,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -147,6 +150,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -725,6 +731,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -741,6 +750,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -841,6 +853,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -854,6 +869,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -941,6 +959,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -957,6 +978,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/udf1.q.xml b/ql/src/test/results/compiler/plan/udf1.q.xml
index 6512365..de7554f 100644
--- a/ql/src/test/results/compiler/plan/udf1.q.xml
+++ b/ql/src/test/results/compiler/plan/udf1.q.xml
@@ -277,6 +277,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -290,6 +293,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -303,6 +309,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -316,6 +325,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -329,6 +341,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -342,6 +357,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -355,6 +373,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -368,6 +389,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -381,6 +405,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -394,6 +421,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -407,6 +437,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -420,6 +453,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -433,6 +469,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -450,6 +489,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -463,6 +505,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -476,6 +521,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -489,6 +537,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -533,9 +584,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
                       </void> 
@@ -581,9 +629,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                       </void> 
@@ -629,9 +674,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                       </void> 
@@ -677,9 +719,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                       </void> 
@@ -725,9 +764,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                       </void> 
@@ -773,9 +809,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                       </void> 
@@ -821,9 +854,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                       </void> 
@@ -869,9 +899,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                       </void> 
@@ -917,9 +944,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
                       </void> 
@@ -972,9 +996,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
                       </void> 
@@ -1020,9 +1041,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
                       </void> 
@@ -1068,9 +1086,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
                       </void> 
@@ -1116,9 +1131,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
                       </void> 
@@ -1171,9 +1183,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
                       </void> 
@@ -1226,9 +1235,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
                       </void> 
@@ -1281,9 +1287,6 @@
                     </void> 
                     <void property="genericUDF"> 
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
                       </void> 
@@ -1329,9 +1332,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                       </void> 
@@ -1502,6 +1502,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1515,6 +1518,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1528,6 +1534,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1541,6 +1550,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1554,6 +1566,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1567,6 +1582,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1580,6 +1598,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1593,6 +1614,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1606,6 +1630,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1619,6 +1646,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1632,6 +1662,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1645,6 +1678,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1658,6 +1694,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1671,6 +1710,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1684,6 +1726,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1697,6 +1742,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1710,6 +1758,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1806,6 +1857,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1877,6 +1931,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1897,6 +1954,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1913,6 +1973,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/udf4.q.xml b/ql/src/test/results/compiler/plan/udf4.q.xml
index 5ffcaeb..a8b06f4 100644
--- a/ql/src/test/results/compiler/plan/udf4.q.xml
+++ b/ql/src/test/results/compiler/plan/udf4.q.xml
@@ -253,6 +253,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -266,6 +269,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -279,6 +285,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -296,6 +305,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -309,6 +321,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -322,6 +337,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -335,6 +353,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -348,6 +369,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -361,6 +385,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -374,6 +401,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -387,6 +417,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -400,6 +433,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -413,6 +449,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>bigint</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -426,6 +465,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>double</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -443,6 +485,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -456,6 +501,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -469,6 +517,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -482,6 +533,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -495,6 +549,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -526,9 +583,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFSqrt</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
                   </void> 
@@ -568,9 +622,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPNegative</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPNegative</string> 
                       </void> 
@@ -588,9 +639,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFSqrt</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
                   </void> 
@@ -623,9 +671,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFSqrt</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
                   </void> 
@@ -665,9 +710,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPNegative</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPNegative</string> 
                       </void> 
@@ -685,9 +727,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFFloor</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFFloor</string> 
                   </void> 
@@ -720,9 +759,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFFloor</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFFloor</string> 
                   </void> 
@@ -755,9 +791,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFFloor</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFFloor</string> 
                   </void> 
@@ -797,9 +830,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPNegative</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPNegative</string> 
                       </void> 
@@ -817,9 +847,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFRound</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFRound</string> 
                   </void> 
@@ -852,9 +879,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFRound</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFRound</string> 
                   </void> 
@@ -887,9 +911,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFCeil</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFCeil</string> 
                   </void> 
@@ -922,9 +943,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFRand</string> 
                   </void> 
@@ -957,9 +975,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFCeil</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFCeil</string> 
                   </void> 
@@ -999,9 +1014,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPNegative</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPNegative</string> 
                       </void> 
@@ -1019,9 +1031,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFCeil</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFCeil</string> 
                   </void> 
@@ -1054,9 +1063,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFCeil</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFCeil</string> 
                   </void> 
@@ -1106,9 +1112,6 @@
                       <void property="operator"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="udfClass"> 
-                       <class>org.apache.hadoop.hive.ql.udf.UDFOPNegative</class> 
-                      </void> 
                       <void property="udfClassName"> 
                        <string>org.apache.hadoop.hive.ql.udf.UDFOPNegative</string> 
                       </void> 
@@ -1129,9 +1132,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                   </void> 
@@ -1177,9 +1177,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> 
                   </void> 
@@ -1215,9 +1212,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPNegative</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPNegative</string> 
                   </void> 
@@ -1261,9 +1255,6 @@
                 </void> 
                 <void property="genericUDF"> 
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFRound</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFRound</string> 
                   </void> 
@@ -1299,9 +1290,6 @@
                   <void property="operator"> 
                    <boolean>true</boolean> 
                   </void> 
-                  <void property="udfClass"> 
-                   <class>org.apache.hadoop.hive.ql.udf.UDFOPBitNot</class> 
-                  </void> 
                   <void property="udfClassName"> 
                    <string>org.apache.hadoop.hive.ql.udf.UDFOPBitNot</string> 
                   </void> 
@@ -1484,6 +1472,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1497,6 +1488,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1510,6 +1504,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1523,6 +1520,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1536,6 +1536,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1549,6 +1552,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1562,6 +1568,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1575,6 +1584,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1588,6 +1600,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1601,6 +1616,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1614,6 +1632,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1627,6 +1648,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1640,6 +1664,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>bigint</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1653,6 +1680,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>double</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1666,6 +1696,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1679,6 +1712,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1692,6 +1728,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1705,6 +1744,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1718,6 +1760,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1782,6 +1827,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1795,6 +1843,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1811,6 +1862,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1827,6 +1881,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/udf6.q.xml b/ql/src/test/results/compiler/plan/udf6.q.xml
index d291202..4b97cd6 100644
--- a/ql/src/test/results/compiler/plan/udf6.q.xml
+++ b/ql/src/test/results/compiler/plan/udf6.q.xml
@@ -273,6 +273,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -290,6 +293,9 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -453,6 +459,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -466,6 +475,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>int</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -526,6 +538,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -539,6 +554,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -559,6 +577,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -575,6 +596,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/udf_case.q.xml b/ql/src/test/results/compiler/plan/udf_case.q.xml
index c1faa22..8f18acb 100644
--- a/ql/src/test/results/compiler/plan/udf_case.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_case.q.xml
@@ -277,6 +277,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -290,6 +293,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -348,6 +354,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -361,6 +370,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -630,6 +642,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -643,6 +658,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -663,6 +681,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -679,6 +700,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo1"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/udf_when.q.xml b/ql/src/test/results/compiler/plan/udf_when.q.xml
index ee6cd5b..e9333b4 100644
--- a/ql/src/test/results/compiler/plan/udf_when.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_when.q.xml
@@ -277,6 +277,9 @@
                             </void> 
                            </object> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -290,6 +293,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -348,6 +354,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -361,6 +370,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -710,6 +722,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -723,6 +738,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -743,6 +761,9 @@
                 </void> 
                </object> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -759,6 +780,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo2"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
diff --git a/ql/src/test/results/compiler/plan/union.q.xml b/ql/src/test/results/compiler/plan/union.q.xml
index 8db0378..ddd66a5 100644
--- a/ql/src/test/results/compiler/plan/union.q.xml
+++ b/ql/src/test/results/compiler/plan/union.q.xml
@@ -134,6 +134,9 @@
                                     </void> 
                                    </object> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                 <void method="add"> 
@@ -147,6 +150,9 @@
                                   <void property="type"> 
                                    <object idref="PrimitiveTypeInfo0"/> 
                                   </void> 
+                                  <void property="typeName"> 
+                                   <string>string</string> 
+                                  </void> 
                                  </object> 
                                 </void> 
                                </object> 
@@ -881,6 +887,9 @@
                               <void property="type"> 
                                <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
+                              <void property="typeName"> 
+                               <string>string</string> 
+                              </void> 
                              </object> 
                             </void> 
                             <void method="add"> 
@@ -897,6 +906,9 @@
                               <void property="type"> 
                                <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
+                              <void property="typeName"> 
+                               <string>string</string> 
+                              </void> 
                              </object> 
                             </void> 
                            </object> 
@@ -1175,6 +1187,9 @@
                                       <void property="type"> 
                                        <object idref="PrimitiveTypeInfo0"/> 
                                       </void> 
+                                      <void property="typeName"> 
+                                       <string>string</string> 
+                                      </void> 
                                      </object> 
                                     </void> 
                                     <void method="add"> 
@@ -1188,6 +1203,9 @@
                                       <void property="type"> 
                                        <object idref="PrimitiveTypeInfo0"/> 
                                       </void> 
+                                      <void property="typeName"> 
+                                       <string>string</string> 
+                                      </void> 
                                      </object> 
                                     </void> 
                                     <void method="add"> 
@@ -1208,6 +1226,9 @@
                                         </void> 
                                        </object> 
                                       </void> 
+                                      <void property="typeName"> 
+                                       <string>bigint</string> 
+                                      </void> 
                                      </object> 
                                     </void> 
                                     <void method="add"> 
@@ -1224,6 +1245,9 @@
                                       <void property="type"> 
                                        <object idref="PrimitiveTypeInfo0"/> 
                                       </void> 
+                                      <void property="typeName"> 
+                                       <string>string</string> 
+                                      </void> 
                                      </object> 
                                     </void> 
                                    </object> 
@@ -1267,6 +1291,9 @@
                               <void property="type"> 
                                <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
+                              <void property="typeName"> 
+                               <string>string</string> 
+                              </void> 
                              </object> 
                             </void> 
                             <void method="add"> 
@@ -1280,6 +1307,9 @@
                               <void property="type"> 
                                <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
+                              <void property="typeName"> 
+                               <string>string</string> 
+                              </void> 
                              </object> 
                             </void> 
                            </object> 
@@ -1305,6 +1335,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
@@ -1318,6 +1351,9 @@
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -1425,6 +1461,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
@@ -1438,6 +1477,9 @@
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -1530,6 +1572,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
@@ -1543,6 +1588,9 @@
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
+                  <void property="typeName"> 
+                   <string>string</string> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
@@ -1626,6 +1674,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo3"/> 
               </void> 
+              <void property="typeName"> 
+               <string>bigint</string> 
+              </void> 
              </object> 
             </void> 
             <void method="add"> 
@@ -1642,6 +1693,9 @@
               <void property="type"> 
                <object idref="PrimitiveTypeInfo0"/> 
               </void> 
+              <void property="typeName"> 
+               <string>string</string> 
+              </void> 
              </object> 
             </void> 
            </object> 
-- 
1.8.3.4 (Apple Git-47)

